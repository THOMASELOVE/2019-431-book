<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS 431</title>
  <meta name="description" content="Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Using Transformations to “Normalize” Distributions | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  
  
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="assessing-normality.html"/>
<link rel="next" href="summarizing-data-within-subgroups.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for PQHS 431</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-philosophy"><i class="fa fa-check"></i>Course Philosophy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#working-with-this-document"><i class="fa fa-check"></i>Working with this Document</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#why-a-unicorn"><i class="fa fa-check"></i><b>1.1</b> Why a unicorn?</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-science-project-cycle"><i class="fa fa-check"></i><b>1.2</b> Data Science Project Cycle</a></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#what-will-we-discuss-in-431"><i class="fa fa-check"></i><b>1.3</b> What Will We Discuss in 431?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rsetup.html"><a href="Rsetup.html"><i class="fa fa-check"></i><b>2</b> Setting Up R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rsetup.html"><a href="Rsetup.html#r-markdown"><i class="fa fa-check"></i><b>2.1</b> R Markdown</a></li>
<li class="chapter" data-level="2.2" data-path="Rsetup.html"><a href="Rsetup.html#r-packages"><i class="fa fa-check"></i><b>2.2</b> R Packages</a></li>
<li class="chapter" data-level="2.3" data-path="Rsetup.html"><a href="Rsetup.html#other-packages"><i class="fa fa-check"></i><b>2.3</b> Other Packages</a></li>
</ul></li>
<li class="part"><span><b>Part A. Exploring Data</b></span></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualizing Data</a><ul>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#the-nhanes-data-collecting-a-sample"><i class="fa fa-check"></i><b>3.1</b> The NHANES data: Collecting a Sample</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#age-and-height"><i class="fa fa-check"></i><b>3.2</b> Age and Height</a></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#subset-of-subjects-with-known-age-and-height"><i class="fa fa-check"></i><b>3.3</b> Subset of Subjects with Known Age and Height</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#the-distinction-between-gender-and-sex"><i class="fa fa-check"></i><b>3.3.1</b> The Distinction between <code>Gender</code> and <code>Sex</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#age-height-and-sex"><i class="fa fa-check"></i><b>3.4</b> Age-Height and Sex?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataviz.html"><a href="dataviz.html#can-we-show-the-female-and-male-relationships-in-separate-panels"><i class="fa fa-check"></i><b>3.4.1</b> Can we show the Female and Male relationships in separate panels?</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataviz.html"><a href="dataviz.html#can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot"><i class="fa fa-check"></i><b>3.4.2</b> Can we add a smooth curve to show the relationship in each plot?</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataviz.html"><a href="dataviz.html#what-if-we-want-to-assume-straight-line-relationships"><i class="fa fa-check"></i><b>3.4.3</b> What if we want to assume straight line relationships?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataviz.html"><a href="dataviz.html#a-new-subset-ages-21-79"><i class="fa fa-check"></i><b>3.5</b> A New Subset: Ages 21-79</a></li>
<li class="chapter" data-level="3.6" data-path="dataviz.html"><a href="dataviz.html#distribution-of-heights"><i class="fa fa-check"></i><b>3.6</b> Distribution of Heights</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dataviz.html"><a href="dataviz.html#changing-a-histograms-fill-and-color"><i class="fa fa-check"></i><b>3.6.1</b> Changing a Histogram’s Fill and Color</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dataviz.html"><a href="dataviz.html#height-and-sex"><i class="fa fa-check"></i><b>3.7</b> Height and Sex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="dataviz.html"><a href="dataviz.html#a-boxplot-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.1</b> A Boxplot of Height by Sex</a></li>
<li class="chapter" data-level="3.7.2" data-path="dataviz.html"><a href="dataviz.html#histograms-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.2</b> Histograms of Height by Sex</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="dataviz.html"><a href="dataviz.html#looking-at-pulse-rate"><i class="fa fa-check"></i><b>3.8</b> Looking at Pulse Rate</a><ul>
<li class="chapter" data-level="3.8.1" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-physical-activity"><i class="fa fa-check"></i><b>3.8.1</b> Pulse Rate and Physical Activity</a></li>
<li class="chapter" data-level="3.8.2" data-path="dataviz.html"><a href="dataviz.html#pulse-by-sleeping-trouble"><i class="fa fa-check"></i><b>3.8.2</b> Pulse by Sleeping Trouble</a></li>
<li class="chapter" data-level="3.8.3" data-path="dataviz.html"><a href="dataviz.html#pulse-and-healthgen"><i class="fa fa-check"></i><b>3.8.3</b> Pulse and HealthGen</a></li>
<li class="chapter" data-level="3.8.4" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-systolic-blood-pressure"><i class="fa fa-check"></i><b>3.8.4</b> Pulse Rate and Systolic Blood Pressure</a></li>
<li class="chapter" data-level="3.8.5" data-path="dataviz.html"><a href="dataviz.html#sleep-troubls-vs.-no-sleep-trouble"><i class="fa fa-check"></i><b>3.8.5</b> Sleep Troubls vs. No Sleep Trouble?</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="dataviz.html"><a href="dataviz.html#general-health-status"><i class="fa fa-check"></i><b>3.9</b> General Health Status</a><ul>
<li class="chapter" data-level="3.9.1" data-path="dataviz.html"><a href="dataviz.html#bar-chart-for-categorical-data"><i class="fa fa-check"></i><b>3.9.1</b> Bar Chart for Categorical Data</a></li>
<li class="chapter" data-level="3.9.2" data-path="dataviz.html"><a href="dataviz.html#working-with-tables"><i class="fa fa-check"></i><b>3.9.2</b> Working with Tables</a></li>
<li class="chapter" data-level="3.9.3" data-path="dataviz.html"><a href="dataviz.html#sbp-by-general-health-status"><i class="fa fa-check"></i><b>3.9.3</b> SBP by General Health Status</a></li>
<li class="chapter" data-level="3.9.4" data-path="dataviz.html"><a href="dataviz.html#sbp-by-physical-activity-and-general-health-status"><i class="fa fa-check"></i><b>3.9.4</b> SBP by Physical Activity and General Health Status</a></li>
<li class="chapter" data-level="3.9.5" data-path="dataviz.html"><a href="dataviz.html#sbp-by-sleep-trouble-and-general-health-status"><i class="fa fa-check"></i><b>3.9.5</b> SBP by Sleep Trouble and General Health Status</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="dataviz.html"><a href="dataviz.html#conclusions"><i class="fa fa-check"></i><b>3.10</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Data Structures and Types of Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#data-require-structure-and-context"><i class="fa fa-check"></i><b>4.1</b> Data require structure and context</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#createnh_adults"><i class="fa fa-check"></i><b>4.2</b> A New NHANES Adult Sample</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#summarizing-the-datas-structure"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing the Data’s Structure</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#what-are-the-variables"><i class="fa fa-check"></i><b>4.2.2</b> What are the variables?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#types-of-variables"><i class="fa fa-check"></i><b>4.3</b> Types of Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#quantitative-variables"><i class="fa fa-check"></i><b>4.3.1</b> Quantitative Variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#qualitative-categorical-variables"><i class="fa fa-check"></i><b>4.3.2</b> Qualitative (Categorical) Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#creating-a-data-report-quickly"><i class="fa fa-check"></i><b>4.4</b> Creating a Data Report Quickly</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html"><i class="fa fa-check"></i><b>5</b> Summarizing Quantitative Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-summary-function-for-quantitative-data"><i class="fa fa-check"></i><b>5.1</b> The <code>summary</code> function for Quantitative data</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-center-of-a-distribution"><i class="fa fa-check"></i><b>5.2</b> Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mean-and-the-median"><i class="fa fa-check"></i><b>5.2.1</b> The Mean and The Median</a></li>
<li class="chapter" data-level="5.2.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#dealing-with-missingness"><i class="fa fa-check"></i><b>5.2.2</b> Dealing with Missingness</a></li>
<li class="chapter" data-level="5.2.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mode-of-a-quantitative-variable"><i class="fa fa-check"></i><b>5.2.3</b> The Mode of a Quantitative Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-spread-of-a-distribution"><i class="fa fa-check"></i><b>5.3</b> Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#rangeandiqr"><i class="fa fa-check"></i><b>5.3.1</b> The Range and the Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-variance-and-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.2</b> The Variance and the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#obtaining-the-variance-and-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.3.3</b> Obtaining the Variance and Standard Deviation in R</a></li>
<li class="chapter" data-level="5.3.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#defining-the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.3.4</b> Defining the Variance and Standard Deviation</a></li>
<li class="chapter" data-level="5.3.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#empirical-rule-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.5</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.6" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#chebyshevs-inequality-one-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.6</b> Chebyshev’s Inequality: One Interpretation of the Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-shape-of-a-distribution"><i class="fa fa-check"></i><b>5.4</b> Measuring the Shape of a Distribution</a><ul>
<li class="chapter" data-level="5.4.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#multimodal-vs.-unimodal-distributions"><i class="fa fa-check"></i><b>5.4.1</b> Multimodal vs. Unimodal distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skew"><i class="fa fa-check"></i><b>5.4.2</b> Skew</a></li>
<li class="chapter" data-level="5.4.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#kurtosis"><i class="fa fa-check"></i><b>5.4.3</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#more-detailed-numerical-summaries-for-quantitative-variables"><i class="fa fa-check"></i><b>5.5</b> More Detailed Numerical Summaries for Quantitative Variables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#favstats-in-the-mosaic-package"><i class="fa fa-check"></i><b>5.5.1</b> <code>favstats</code> in the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skim-in-the-skimr-package"><i class="fa fa-check"></i><b>5.5.2</b> <code>skim</code> in the <code>skimr</code> package</a></li>
<li class="chapter" data-level="5.5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-psych-package"><i class="fa fa-check"></i><b>5.5.3</b> <code>describe</code> in the <code>psych</code> package</a></li>
<li class="chapter" data-level="5.5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>5.5.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="5.5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#other-options"><i class="fa fa-check"></i><b>5.5.5</b> Other options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html"><i class="fa fa-check"></i><b>6</b> Summarizing Categorical Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-summary-function-for-categorical-data"><i class="fa fa-check"></i><b>6.1</b> The <code>summary</code> function for Categorical data</a></li>
<li class="chapter" data-level="6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#tables-to-describe-one-categorical-variable"><i class="fa fa-check"></i><b>6.2</b> Tables to describe One Categorical Variable</a></li>
<li class="chapter" data-level="6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-mode-of-a-categorical-variable"><i class="fa fa-check"></i><b>6.3</b> The Mode of a Categorical Variable</a></li>
<li class="chapter" data-level="6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#describe-in-the-hmisc-package-1"><i class="fa fa-check"></i><b>6.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="6.5" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-tabulations"><i class="fa fa-check"></i><b>6.5</b> Cross-Tabulations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-classifying-three-categorical-variables"><i class="fa fa-check"></i><b>6.5.1</b> Cross-Classifying Three Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#constructing-tables-well"><i class="fa fa-check"></i><b>6.6</b> Constructing Tables Well</a><ul>
<li class="chapter" data-level="6.6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#alabama-first"><i class="fa fa-check"></i><b>6.6.1</b> Alabama First!</a></li>
<li class="chapter" data-level="6.6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#order-rows-and-columns-sensibly"><i class="fa fa-check"></i><b>6.6.2</b> Order rows and columns sensibly</a></li>
<li class="chapter" data-level="6.6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#round---a-lot"><i class="fa fa-check"></i><b>6.6.3</b> Round - a lot!</a></li>
<li class="chapter" data-level="6.6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#all-is-different-and-important"><i class="fa fa-check"></i><b>6.6.4</b> ALL is different and important</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="NYFS-Study.html"><a href="NYFS-Study.html"><i class="fa fa-check"></i><b>7</b> NHANES National Youth Fitness Survey (<code>nnyfs</code>)</a><ul>
<li class="chapter" data-level="7.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-variables-included-in-nnyfs"><i class="fa fa-check"></i><b>7.1</b> The Variables included in <code>nnyfs</code></a><ul>
<li class="chapter" data-level="7.1.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-demographic-component"><i class="fa fa-check"></i><b>7.1.1</b> From the <span>NNYFS Demographic Component</span></a></li>
<li class="chapter" data-level="7.1.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-dietary-component"><i class="fa fa-check"></i><b>7.1.2</b> From the <span>NNYFS Dietary Component</span></a></li>
<li class="chapter" data-level="7.1.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-examination-component"><i class="fa fa-check"></i><b>7.1.3</b> From the <span>NNYFS Examination Component</span></a></li>
<li class="chapter" data-level="7.1.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-questionnaire-component"><i class="fa fa-check"></i><b>7.1.4</b> From the <span>NNYFS Questionnaire Component</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#looking-over-the-data-set"><i class="fa fa-check"></i><b>7.2</b> Looking over the Data Set</a><ul>
<li class="chapter" data-level="7.2.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#seqn"><i class="fa fa-check"></i><b>7.2.1</b> <code>SEQN</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#sex"><i class="fa fa-check"></i><b>7.2.2</b> <code>sex</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#age_child"><i class="fa fa-check"></i><b>7.2.3</b> <code>age_child</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#race_eth"><i class="fa fa-check"></i><b>7.2.4</b> <code>race_eth</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#income_pov"><i class="fa fa-check"></i><b>7.2.5</b> <code>income_pov</code></a></li>
<li class="chapter" data-level="7.2.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi"><i class="fa fa-check"></i><b>7.2.6</b> <code>bmi</code></a></li>
<li class="chapter" data-level="7.2.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi_cat"><i class="fa fa-check"></i><b>7.2.7</b> <code>bmi_cat</code></a></li>
<li class="chapter" data-level="7.2.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#waist"><i class="fa fa-check"></i><b>7.2.8</b> <code>waist</code></a></li>
<li class="chapter" data-level="7.2.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#triceps_skinfold"><i class="fa fa-check"></i><b>7.2.9</b> <code>triceps_skinfold</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#basic-numerical-summaries"><i class="fa fa-check"></i><b>7.3</b> Basic Numerical Summaries</a><ul>
<li class="chapter" data-level="7.3.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-five-number-summary-quantiles-and-iqr"><i class="fa fa-check"></i><b>7.3.1</b> The Five Number Summary, Quantiles and IQR</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#additional-summaries-from-favstats"><i class="fa fa-check"></i><b>7.4</b> Additional Summaries from <code>favstats</code></a></li>
<li class="chapter" data-level="7.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-histogram"><i class="fa fa-check"></i><b>7.5</b> The Histogram</a><ul>
<li class="chapter" data-level="7.5.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#freedman-diaconis-rule-to-select-bin-width"><i class="fa fa-check"></i><b>7.5.1</b> Freedman-Diaconis Rule to select bin width</a></li>
<li class="chapter" data-level="7.5.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-note-on-colors"><i class="fa fa-check"></i><b>7.5.2</b> A Note on Colors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-stem-and-leaf"><i class="fa fa-check"></i><b>7.6</b> The Stem-and-Leaf</a><ul>
<li class="chapter" data-level="7.6.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-fancier-stem-and-leaf-display"><i class="fa fa-check"></i><b>7.6.1</b> A Fancier Stem-and-Leaf Display</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-dot-plot-to-display-a-distribution"><i class="fa fa-check"></i><b>7.7</b> The Dot Plot to display a distribution</a></li>
<li class="chapter" data-level="7.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-frequency-polygon"><i class="fa fa-check"></i><b>7.8</b> The Frequency Polygon</a></li>
<li class="chapter" data-level="7.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#plotting-the-probability-density-function"><i class="fa fa-check"></i><b>7.9</b> Plotting the Probability Density Function</a></li>
<li class="chapter" data-level="7.10" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-boxplot"><i class="fa fa-check"></i><b>7.10</b> The Boxplot</a><ul>
<li class="chapter" data-level="7.10.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#drawing-a-boxplot-for-one-variable-in-ggplot2"><i class="fa fa-check"></i><b>7.10.1</b> Drawing a Boxplot for One Variable in <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#about-the-boxplot"><i class="fa fa-check"></i><b>7.10.2</b> About the Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-simple-comparison-boxplot"><i class="fa fa-check"></i><b>7.11</b> A Simple Comparison Boxplot</a></li>
<li class="chapter" data-level="7.12" data-path="NYFS-Study.html"><a href="NYFS-Study.html#using-describe-in-the-psych-library"><i class="fa fa-check"></i><b>7.12</b> Using <code>describe</code> in the <code>psych</code> library</a><ul>
<li class="chapter" data-level="7.12.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-trimmed-mean"><i class="fa fa-check"></i><b>7.12.1</b> The Trimmed Mean</a></li>
<li class="chapter" data-level="7.12.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-median-absolute-deviation"><i class="fa fa-check"></i><b>7.12.2</b> The Median Absolute Deviation</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-skew"><i class="fa fa-check"></i><b>7.13</b> Assessing Skew</a><ul>
<li class="chapter" data-level="7.13.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#non-parametric-skew-via-skew1"><i class="fa fa-check"></i><b>7.13.1</b> Non-parametric Skew via skew<sub>1</sub></a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-kurtosis-heavy-tailedness"><i class="fa fa-check"></i><b>7.14</b> Assessing Kurtosis (Heavy-Tailedness)</a><ul>
<li class="chapter" data-level="7.14.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-standard-error-of-the-sample-mean"><i class="fa fa-check"></i><b>7.14.1</b> The Standard Error of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-describe-function-in-the-hmisc-library"><i class="fa fa-check"></i><b>7.15</b> The <code>describe</code> function in the <code>Hmisc</code> library</a></li>
<li class="chapter" data-level="7.16" data-path="NYFS-Study.html"><a href="NYFS-Study.html#xda-from-github-for-numerical-summaries-for-exploratory-data-analysis"><i class="fa fa-check"></i><b>7.16</b> <code>xda</code> from GitHub for numerical summaries for exploratory data analysis</a></li>
<li class="chapter" data-level="7.17" data-path="NYFS-Study.html"><a href="NYFS-Study.html#what-summaries-to-report"><i class="fa fa-check"></i><b>7.17</b> What Summaries to Report</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="assessing-normality.html"><a href="assessing-normality.html"><i class="fa fa-check"></i><b>8</b> Assessing Normality</a><ul>
<li class="chapter" data-level="8.1" data-path="assessing-normality.html"><a href="assessing-normality.html#empirical-rule-interpretation-of-the-standard-deviation-1"><i class="fa fa-check"></i><b>8.1</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="8.2" data-path="assessing-normality.html"><a href="assessing-normality.html#describing-outlying-values-with-z-scores"><i class="fa fa-check"></i><b>8.2</b> Describing Outlying Values with Z Scores</a><ul>
<li class="chapter" data-level="8.2.1" data-path="assessing-normality.html"><a href="assessing-normality.html#fences-and-z-scores"><i class="fa fa-check"></i><b>8.2.1</b> Fences and Z Scores</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="assessing-normality.html"><a href="assessing-normality.html#comparing-a-histogram-to-a-normal-distribution"><i class="fa fa-check"></i><b>8.3</b> Comparing a Histogram to a Normal Distribution</a><ul>
<li class="chapter" data-level="8.3.1" data-path="assessing-normality.html"><a href="assessing-normality.html#histogram-of-energy-with-normal-model-with-counts"><i class="fa fa-check"></i><b>8.3.1</b> Histogram of <code>energy</code> with Normal model (with Counts)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="assessing-normality.html"><a href="assessing-normality.html#does-a-normal-model-work-well-for-the-waist-circumference"><i class="fa fa-check"></i><b>8.4</b> Does a Normal model work well for the <code>waist</code> circumference?</a></li>
<li class="chapter" data-level="8.5" data-path="assessing-normality.html"><a href="assessing-normality.html#the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.5</b> The Normal Q-Q Plot</a></li>
<li class="chapter" data-level="8.6" data-path="assessing-normality.html"><a href="assessing-normality.html#interpreting-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6</b> Interpreting the Normal Q-Q Plot</a><ul>
<li class="chapter" data-level="8.6.1" data-path="assessing-normality.html"><a href="assessing-normality.html#data-from-a-normal-distribution-shows-up-as-a-straight-line-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.1</b> Data from a Normal distribution shows up as a straight line in a Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.2" data-path="assessing-normality.html"><a href="assessing-normality.html#skew-is-indicated-by-monotonic-curves-in-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.2</b> Skew is indicated by monotonic curves in the Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.3" data-path="assessing-normality.html"><a href="assessing-normality.html#direction-of-skew"><i class="fa fa-check"></i><b>8.6.3</b> Direction of Skew</a></li>
<li class="chapter" data-level="8.6.4" data-path="assessing-normality.html"><a href="assessing-normality.html#outlier-proneness-is-indicated-by-s-shaped-curves-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.4</b> Outlier-proneness is indicated by “s-shaped” curves in a Normal Q-Q plot</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="assessing-normality.html"><a href="assessing-normality.html#can-a-normal-distribution-fit-the-nnyfs-energy-data-well"><i class="fa fa-check"></i><b>8.7</b> Can a Normal Distribution Fit the <code>nnyfs</code> <code>energy</code> data Well?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html"><i class="fa fa-check"></i><b>9</b> Using Transformations to “Normalize” Distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-ladder-of-power-transformations"><i class="fa fa-check"></i><b>9.1</b> The Ladder of Power Transformations</a></li>
<li class="chapter" data-level="9.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-the-ladder"><i class="fa fa-check"></i><b>9.2</b> Using the Ladder</a></li>
<li class="chapter" data-level="9.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#protein-consumption-in-the-nnyfs-data"><i class="fa fa-check"></i><b>9.3</b> Protein Consumption in the NNYFS data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-cowplotplot_grid-to-compose-plots"><i class="fa fa-check"></i><b>9.3.1</b> Using <code>cowplot::plot_grid()</code> to compose plots</a></li>
<li class="chapter" data-level="9.3.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-patchwork-to-compose-plots"><i class="fa fa-check"></i><b>9.3.2</b> Using <code>patchwork</code> to compose plots</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#can-we-transform-the-protein-data"><i class="fa fa-check"></i><b>9.4</b> Can we transform the <code>protein</code> data?</a><ul>
<li class="chapter" data-level="9.4.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-square-root"><i class="fa fa-check"></i><b>9.4.1</b> The Square Root</a></li>
<li class="chapter" data-level="9.4.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-logarithm"><i class="fa fa-check"></i><b>9.4.2</b> The Logarithm</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations"><i class="fa fa-check"></i><b>9.5</b> What if we considered all 9 available transformations?</a></li>
<li class="chapter" data-level="9.6" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#a-simulated-data-set"><i class="fa fa-check"></i><b>9.6</b> A Simulated Data Set</a><ul>
<li class="chapter" data-level="9.6.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#transformation-example-2-ladder-with-normal-q-q-plots"><i class="fa fa-check"></i><b>9.6.1</b> Transformation Example 2 Ladder with Normal Q-Q Plots</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations-1"><i class="fa fa-check"></i><b>9.7</b> What if we considered all 9 available transformations?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html"><i class="fa fa-check"></i><b>10</b> Summarizing data within subgroups</a><ul>
<li class="chapter" data-level="10.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-dplyr-and-summarise-to-build-a-tibble-of-summary-information"><i class="fa fa-check"></i><b>10.1</b> Using dplyr and summarise to build a tibble of summary information</a></li>
<li class="chapter" data-level="10.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#another-example"><i class="fa fa-check"></i><b>10.2</b> Another Example</a></li>
<li class="chapter" data-level="10.3" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#boxplots-to-relate-an-outcome-to-a-categorical-predictor"><i class="fa fa-check"></i><b>10.3</b> Boxplots to Relate an Outcome to a Categorical Predictor</a><ul>
<li class="chapter" data-level="10.3.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#augmenting-the-boxplot-with-the-sample-mean"><i class="fa fa-check"></i><b>10.3.1</b> Augmenting the Boxplot with the Sample Mean</a></li>
<li class="chapter" data-level="10.3.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#adding-notches-to-a-boxplot"><i class="fa fa-check"></i><b>10.3.2</b> Adding Notches to a Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-histograms-to-make-comparisons"><i class="fa fa-check"></i><b>10.4</b> Using Multiple Histograms to Make Comparisons</a></li>
<li class="chapter" data-level="10.5" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-density-plots-to-make-comparisons"><i class="fa fa-check"></i><b>10.5</b> Using Multiple Density Plots to Make Comparisons</a></li>
<li class="chapter" data-level="10.6" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#building-a-violin-plot"><i class="fa fa-check"></i><b>10.6</b> Building a Violin Plot</a></li>
<li class="chapter" data-level="10.7" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#a-ridgeline-plot"><i class="fa fa-check"></i><b>10.7</b> A Ridgeline Plot</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html"><i class="fa fa-check"></i><b>11</b> Straight Line Models and Correlation</a><ul>
<li class="chapter" data-level="11.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#assessing-a-scatterplot"><i class="fa fa-check"></i><b>11.1</b> Assessing A Scatterplot</a><ul>
<li class="chapter" data-level="11.1.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#highlighting-an-unusual-point"><i class="fa fa-check"></i><b>11.1.1</b> Highlighting an unusual point</a></li>
<li class="chapter" data-level="11.1.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#adding-a-scatterplot-smooth-using-loess"><i class="fa fa-check"></i><b>11.1.2</b> Adding a Scatterplot Smooth using loess</a></li>
<li class="chapter" data-level="11.1.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#what-line-does-r-fit"><i class="fa fa-check"></i><b>11.1.3</b> What Line Does R Fit?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlation-coefficients"><i class="fa fa-check"></i><b>11.2</b> Correlation Coefficients</a></li>
<li class="chapter" data-level="11.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>11.3</b> The Pearson Correlation Coefficient</a></li>
<li class="chapter" data-level="11.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#a-simulated-example"><i class="fa fa-check"></i><b>11.4</b> A simulated example</a><ul>
<li class="chapter" data-level="11.4.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-alex"><i class="fa fa-check"></i><b>11.4.1</b> Data Set Alex</a></li>
<li class="chapter" data-level="11.4.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-bonnie"><i class="fa fa-check"></i><b>11.4.2</b> Data Set Bonnie</a></li>
<li class="chapter" data-level="11.4.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlations-for-all-six-data-sets-in-the-correx1-example"><i class="fa fa-check"></i><b>11.4.3</b> Correlations for All Six Data Sets in the Correx1 Example</a></li>
<li class="chapter" data-level="11.4.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-colin"><i class="fa fa-check"></i><b>11.4.4</b> Data Set Colin</a></li>
<li class="chapter" data-level="11.4.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#draw-the-picture"><i class="fa fa-check"></i><b>11.4.5</b> Draw the Picture!</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#estimating-correlation-from-scatterplots"><i class="fa fa-check"></i><b>11.5</b> Estimating Correlation from Scatterplots</a></li>
<li class="chapter" data-level="11.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-spearman-rank-correlation"><i class="fa fa-check"></i><b>11.6</b> The Spearman Rank Correlation</a><ul>
<li class="chapter" data-level="11.6.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-formula"><i class="fa fa-check"></i><b>11.6.1</b> Spearman Formula</a></li>
<li class="chapter" data-level="11.6.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#comparing-pearson-and-spearman-correlations"><i class="fa fa-check"></i><b>11.6.2</b> Comparing Pearson and Spearman Correlations</a></li>
<li class="chapter" data-level="11.6.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-1"><i class="fa fa-check"></i><b>11.6.3</b> Spearman vs. Pearson Example 1</a></li>
<li class="chapter" data-level="11.6.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-2"><i class="fa fa-check"></i><b>11.6.4</b> Spearman vs. Pearson Example 2</a></li>
<li class="chapter" data-level="11.6.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-3"><i class="fa fa-check"></i><b>11.6.5</b> Spearman vs. Pearson Example 3</a></li>
<li class="chapter" data-level="11.6.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-4"><i class="fa fa-check"></i><b>11.6.6</b> Spearman vs. Pearson Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html"><i class="fa fa-check"></i><b>12</b> Studying Crab Claws (<code>crabs</code>)</a><ul>
<li class="chapter" data-level="12.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#association-of-size-and-force"><i class="fa fa-check"></i><b>12.1</b> Association of Size and Force</a></li>
<li class="chapter" data-level="12.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#loess_smooth"><i class="fa fa-check"></i><b>12.2</b> The <code>loess</code> smooth</a><ul>
<li class="chapter" data-level="12.2.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#smoothing-within-species"><i class="fa fa-check"></i><b>12.2.1</b> Smoothing within Species</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>12.3</b> Fitting a Linear Regression Model</a></li>
<li class="chapter" data-level="12.4" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#is-a-linear-model-appropriate"><i class="fa fa-check"></i><b>12.4</b> Is a Linear Model Appropriate?</a><ul>
<li class="chapter" data-level="12.4.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#the-log-log-model"><i class="fa fa-check"></i><b>12.4.1</b> The log-log model</a></li>
<li class="chapter" data-level="12.4.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#how-does-this-compare-to-our-original-linear-model"><i class="fa fa-check"></i><b>12.4.2</b> How does this compare to our original linear model?</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#making-predictions-with-a-model"><i class="fa fa-check"></i><b>12.5</b> Making Predictions with a Model</a><ul>
<li class="chapter" data-level="12.5.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#predictions-after-a-transformation"><i class="fa fa-check"></i><b>12.5.1</b> Predictions After a Transformation</a></li>
<li class="chapter" data-level="12.5.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#comparing-model-predictions"><i class="fa fa-check"></i><b>12.5.2</b> Comparing Model Predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="WCGS-Study.html"><a href="WCGS-Study.html"><i class="fa fa-check"></i><b>13</b> The Western Collaborative Group Study</a><ul>
<li class="chapter" data-level="13.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#the-western-collaborative-group-study-wcgs-data-set"><i class="fa fa-check"></i><b>13.1</b> The Western Collaborative Group Study (<code>wcgs</code>) data set</a><ul>
<li class="chapter" data-level="13.1.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#structure-of-wcgs"><i class="fa fa-check"></i><b>13.1.1</b> Structure of <code>wcgs</code></a></li>
<li class="chapter" data-level="13.1.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#codebook-for-wcgs"><i class="fa fa-check"></i><b>13.1.2</b> Codebook for <code>wcgs</code></a></li>
<li class="chapter" data-level="13.1.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#quick-summary"><i class="fa fa-check"></i><b>13.1.3</b> Quick Summary</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#are-the-sbps-normally-distributed"><i class="fa fa-check"></i><b>13.2</b> Are the SBPs Normally Distributed?</a></li>
<li class="chapter" data-level="13.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#describing-outlying-values-with-z-scores-1"><i class="fa fa-check"></i><b>13.3</b> Describing Outlying Values with Z Scores</a></li>
<li class="chapter" data-level="13.4" data-path="WCGS-Study.html"><a href="WCGS-Study.html#does-weight-category-relate-to-sbp"><i class="fa fa-check"></i><b>13.4</b> Does Weight Category Relate to SBP?</a></li>
<li class="chapter" data-level="13.5" data-path="WCGS-Study.html"><a href="WCGS-Study.html#re-leveling-a-factor"><i class="fa fa-check"></i><b>13.5</b> Re-Leveling a Factor</a><ul>
<li class="chapter" data-level="13.5.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#sbp-by-weight-category"><i class="fa fa-check"></i><b>13.5.1</b> SBP by Weight Category</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="WCGS-Study.html"><a href="WCGS-Study.html#are-weight-and-sbp-linked"><i class="fa fa-check"></i><b>13.6</b> Are Weight and SBP Linked?</a></li>
<li class="chapter" data-level="13.7" data-path="WCGS-Study.html"><a href="WCGS-Study.html#sbp-and-weight-by-arcus-senilis-groups"><i class="fa fa-check"></i><b>13.7</b> SBP and Weight by Arcus Senilis groups?</a></li>
<li class="chapter" data-level="13.8" data-path="WCGS-Study.html"><a href="WCGS-Study.html#linear-model-for-sbp-weight-relationship-subjects-without-arcus-senilis"><i class="fa fa-check"></i><b>13.8</b> Linear Model for SBP-Weight Relationship: subjects without Arcus Senilis</a></li>
<li class="chapter" data-level="13.9" data-path="WCGS-Study.html"><a href="WCGS-Study.html#linear-model-for-sbp-weight-relationship-subjects-with-arcus-senilis"><i class="fa fa-check"></i><b>13.9</b> Linear Model for SBP-Weight Relationship: subjects with Arcus Senilis</a></li>
<li class="chapter" data-level="13.10" data-path="WCGS-Study.html"><a href="WCGS-Study.html#including-arcus-status-in-the-model"><i class="fa fa-check"></i><b>13.10</b> Including Arcus Status in the model</a></li>
<li class="chapter" data-level="13.11" data-path="WCGS-Study.html"><a href="WCGS-Study.html#predictions-from-these-linear-models"><i class="fa fa-check"></i><b>13.11</b> Predictions from these Linear Models</a></li>
<li class="chapter" data-level="13.12" data-path="WCGS-Study.html"><a href="WCGS-Study.html#scatterplots-with-facets-across-a-categorical-variable"><i class="fa fa-check"></i><b>13.12</b> Scatterplots with Facets Across a Categorical Variable</a></li>
<li class="chapter" data-level="13.13" data-path="WCGS-Study.html"><a href="WCGS-Study.html#scatterplot-and-correlation-matrices"><i class="fa fa-check"></i><b>13.13</b> Scatterplot and Correlation Matrices</a><ul>
<li class="chapter" data-level="13.13.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#using-the-car-package"><i class="fa fa-check"></i><b>13.13.1</b> Using the car package</a></li>
<li class="chapter" data-level="13.13.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#displaying-a-correlation-matrix"><i class="fa fa-check"></i><b>13.13.2</b> Displaying a Correlation Matrix</a></li>
<li class="chapter" data-level="13.13.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#using-the-ggally-package"><i class="fa fa-check"></i><b>13.13.3</b> Using the <code>GGally</code> package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html"><i class="fa fa-check"></i><b>14</b> Part A: A Few of the Key Points</a><ul>
<li class="chapter" data-level="14.1" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#key-graphical-descriptive-summaries-for-quantitative-data"><i class="fa fa-check"></i><b>14.1</b> Key Graphical Descriptive Summaries for Quantitative Data</a></li>
<li class="chapter" data-level="14.2" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#key-numerical-descriptive-summaries-for-quantitative-data"><i class="fa fa-check"></i><b>14.2</b> Key Numerical Descriptive Summaries for Quantitative Data</a></li>
<li class="chapter" data-level="14.3" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#the-empirical-rule---interpreting-a-standard-deviation"><i class="fa fa-check"></i><b>14.3</b> The Empirical Rule - Interpreting a Standard Deviation</a></li>
<li class="chapter" data-level="14.4" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#identifying-outliers-using-fences-andor-z-scores"><i class="fa fa-check"></i><b>14.4</b> Identifying “Outliers” Using Fences and/or Z Scores</a></li>
<li class="chapter" data-level="14.5" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#summarizing-bivariate-associations-scatterplots-and-regression-lines"><i class="fa fa-check"></i><b>14.5</b> Summarizing Bivariate Associations: Scatterplots and Regression Lines</a></li>
<li class="chapter" data-level="14.6" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#summarizing-bivariate-associations-with-correlations"><i class="fa fa-check"></i><b>14.6</b> Summarizing Bivariate Associations With Correlations</a></li>
</ul></li>
<li class="part"><span><b>Part B. Making Comparisons</b></span></li>
<li class="chapter" data-level="15" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html"><i class="fa fa-check"></i><b>15</b> Introduction to Part B</a><ul>
<li class="chapter" data-level="15.1" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#point-estimation-and-confidence-intervals"><i class="fa fa-check"></i><b>15.1</b> Point Estimation and Confidence Intervals</a></li>
<li class="chapter" data-level="15.2" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#one-sample-confidence-intervals"><i class="fa fa-check"></i><b>15.2</b> One-Sample Confidence Intervals</a></li>
<li class="chapter" data-level="15.3" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#comparing-two-groups"><i class="fa fa-check"></i><b>15.3</b> Comparing Two Groups</a><ul>
<li class="chapter" data-level="15.3.1" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#model-based-comparisons-and-anovaregression"><i class="fa fa-check"></i><b>15.3.1</b> Model-Based Comparisons and ANOVA/Regression</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#special-tools-for-categorical-data"><i class="fa fa-check"></i><b>15.4</b> Special Tools for Categorical Data</a></li>
<li class="chapter" data-level="15.5" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#our-first-three-studies"><i class="fa fa-check"></i><b>15.5</b> Our First Three Studies</a></li>
<li class="chapter" data-level="15.6" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#data-sets-used-in-part-b"><i class="fa fa-check"></i><b>15.6</b> Data Sets used in Part B</a></li>
<li class="chapter" data-level="15.7" data-path="introduction-to-part-b.html"><a href="introduction-to-part-b.html#the-love-boost.r-script"><i class="fa fa-check"></i><b>15.7</b> The <code>Love-boost.R</code> script</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html"><i class="fa fa-check"></i><b>16</b> The Serum Zinc Study</a><ul>
<li class="chapter" data-level="16.1" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#serum-zinc-levels-in-462-teenage-males-serzinc"><i class="fa fa-check"></i><b>16.1</b> Serum Zinc Levels in 462 Teenage Males (<code>serzinc</code>)</a></li>
<li class="chapter" data-level="16.2" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#our-goal-a-confidence-interval-for-the-population-mean"><i class="fa fa-check"></i><b>16.2</b> Our Goal: A Confidence Interval for the Population Mean</a></li>
<li class="chapter" data-level="16.3" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#exploratory-data-analysis-for-serum-zinc"><i class="fa fa-check"></i><b>16.3</b> Exploratory Data Analysis for Serum Zinc</a><ul>
<li class="chapter" data-level="16.3.1" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#comparison-to-normal-zinc-levels"><i class="fa fa-check"></i><b>16.3.1</b> Comparison to “Normal” Zinc Levels</a></li>
<li class="chapter" data-level="16.3.2" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#graphical-summaries"><i class="fa fa-check"></i><b>16.3.2</b> Graphical Summaries</a></li>
<li class="chapter" data-level="16.3.3" data-path="Serum-Zinc-Study.html"><a href="Serum-Zinc-Study.html#numerical-summaries"><i class="fa fa-check"></i><b>16.3.3</b> Numerical Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html"><i class="fa fa-check"></i><b>17</b> A Paired Sample Study: Lead in the Blood of Children</a><ul>
<li class="chapter" data-level="17.1" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#the-lead-in-the-blood-of-children-study"><i class="fa fa-check"></i><b>17.1</b> The Lead in the Blood of Children Study</a><ul>
<li class="chapter" data-level="17.1.1" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#our-key-questions-for-a-paired-samples-comparison"><i class="fa fa-check"></i><b>17.1.1</b> Our Key Questions for a Paired Samples Comparison</a></li>
<li class="chapter" data-level="17.1.2" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#lead-study-caveats"><i class="fa fa-check"></i><b>17.1.2</b> Lead Study Caveats</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#exploratory-data-analysis-for-paired-samples"><i class="fa fa-check"></i><b>17.2</b> Exploratory Data Analysis for Paired Samples</a><ul>
<li class="chapter" data-level="17.2.1" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#the-paired-differences"><i class="fa fa-check"></i><b>17.2.1</b> The Paired Differences</a></li>
<li class="chapter" data-level="17.2.2" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#numerical-summaries-1"><i class="fa fa-check"></i><b>17.2.2</b> Numerical Summaries</a></li>
<li class="chapter" data-level="17.2.3" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#impact-of-matching---scatterplot-and-correlation"><i class="fa fa-check"></i><b>17.2.3</b> Impact of Matching - Scatterplot and Correlation</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="Blood-Lead-Study.html"><a href="Blood-Lead-Study.html#looking-at-the-individual-samples-tidying-the-data-with-gather"><i class="fa fa-check"></i><b>17.3</b> Looking at the Individual Samples: Tidying the Data with <code>gather</code></a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html"><i class="fa fa-check"></i><b>18</b> A Study Comparing Two Independent Samples: Ibuprofen in Sepsis Trial</a><ul>
<li class="chapter" data-level="18.1" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html#the-ibuprofen-in-sepsis-randomized-clinical-trial"><i class="fa fa-check"></i><b>18.1</b> The Ibuprofen in Sepsis Randomized Clinical Trial</a><ul>
<li class="chapter" data-level="18.1.1" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html#matched-pairs-vs.-two-independent-samples"><i class="fa fa-check"></i><b>18.1.1</b> Matched Pairs vs. Two Independent Samples</a></li>
<li class="chapter" data-level="18.1.2" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html#our-key-questions-for-an-independent-samples-comparison"><i class="fa fa-check"></i><b>18.1.2</b> Our Key Questions for an Independent Samples Comparison</a></li>
<li class="chapter" data-level="18.1.3" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html#rct-caveats"><i class="fa fa-check"></i><b>18.1.3</b> RCT Caveats</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="Sepsis-RCT.html"><a href="Sepsis-RCT.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>18.2</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="this-is-work-in-progress.html"><a href="this-is-work-in-progress.html"><i class="fa fa-check"></i>This is Work in Progress</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for PQHS 431</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-transformations-to-normalize-distributions" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Using Transformations to “Normalize” Distributions</h1>
<ul>
<li>When we are confronted with a variable that is not Normally distributed but that we wish was Normally distributed, it is sometimes useful to consider whether working with a transformation of the data will yield a more helpful result.</li>
<li>Many statistical methods, including t tests and analyses of variance, assume Normal distributions.</li>
<li>We’ll discuss using R to assess a range of what are called Box-Cox power transformations, via plots, mainly.</li>
</ul>
<div id="the-ladder-of-power-transformations" class="section level2">
<h2><span class="header-section-number">9.1</span> The Ladder of Power Transformations</h2>
<p>The key notion in re-expression of a single variable to obtain a distribution better approximated by the Normal or re-expression of an outcome in a simple regression model is that of a <strong>ladder of power transformations</strong>, which applies to any unimodal data.</p>
<table>
<thead>
<tr class="header">
<th align="center">Power</th>
<th align="center">Transformation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">3</td>
<td align="center">x<sup>3</sup></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">x<sup>2</sup></td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">x (unchanged)</td>
</tr>
<tr class="even">
<td align="center">0.5</td>
<td align="center">x<sup>0.5</sup> = <span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">ln x</td>
</tr>
<tr class="even">
<td align="center">-0.5</td>
<td align="center">x<sup>-0.5</sup> = 1/<span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
<tr class="odd">
<td align="center">-1</td>
<td align="center">x<sup>-1</sup> = 1/x</td>
</tr>
<tr class="even">
<td align="center">-2</td>
<td align="center">x<sup>-2</sup> = 1/x<sup>2</sup></td>
</tr>
</tbody>
</table>
</div>
<div id="using-the-ladder" class="section level2">
<h2><span class="header-section-number">9.2</span> Using the Ladder</h2>
<p>As we move further away from the <em>identity</em> function (power = 1) we change the shape more and more in the same general direction.</p>
<ul>
<li>For instance, if we try a logarithm, and this seems like too much of a change, we might try a square root instead.</li>
<li>Note that this ladder (which like many other things is due to John Tukey) uses the logarithm for the “power zero” transformation rather than the constant, which is what x<sup>0</sup> actually is.</li>
<li>If the variable x can take on negative values, we might take a different approach. If x is a count of something that could be zero, we often simply add 1 to x before transformation.</li>
</ul>
<p>The ladder of power transformations is particularly helpful when we are confronted with data that shows skew.</p>
<ul>
<li>To handle right skew (where the mean exceeds the median) we usually apply powers below 1.</li>
<li>To handle left skew (where the median exceeds the mean) we usually apply powers greater than 1.</li>
</ul>
<p>The most common transformations are the square (power 2), the square root (power 1/2), the logarithm (power 0) and the inverse (power -1), and I usually restrict myself to those options in practical work.</p>
</div>
<div id="protein-consumption-in-the-nnyfs-data" class="section level2">
<h2><span class="header-section-number">9.3</span> Protein Consumption in the NNYFS data</h2>
<p>Here are the protein consumption (in grams) results from the NNYFS data.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1">mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>protein, <span class="dt">data =</span> nnyfs)</a></code></pre></div>
<pre><code>  min   Q1 median   Q3 max mean sd    n missing
 4.18 45.3   61.3 82.6 242 66.9 31 1518       0</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;Protein&quot;</span>, <span class="dt">y =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-2" title="2"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb274-3" title="3"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb274-4" title="4">                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-5" title="5"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb274-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein consumption&quot;</span>,</a>
<a class="sourceLine" id="cb274-7" title="7">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb274-8" title="8"></a>
<a class="sourceLine" id="cb274-9" title="9">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-10" title="10"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb274-11" title="11"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb274-13" title="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein Consumption&quot;</span>,</a>
<a class="sourceLine" id="cb274-14" title="14">         <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb274-15" title="15"></a>
<a class="sourceLine" id="cb274-16" title="16">gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(p1, p2, <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>The key point here is that we see several signs of meaningful right skew, and we’ll want to consider a transformation that might make a Normal model more plausible.</p>
<div id="using-cowplotplot_grid-to-compose-plots" class="section level3">
<h3><span class="header-section-number">9.3.1</span> Using <code>cowplot::plot_grid()</code> to compose plots</h3>
<p>In addition to the <code>grid.arrange</code> function in <code>gridExtra</code>, we could also use <code>plot_grid()</code> in the <code>cowplot</code> package to put our plots together.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;Protein&quot;</span>, <span class="dt">y =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-2" title="2"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb275-3" title="3"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb275-4" title="4">                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-5" title="5"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb275-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein consumption&quot;</span>,</a>
<a class="sourceLine" id="cb275-7" title="7">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb275-8" title="8"></a>
<a class="sourceLine" id="cb275-9" title="9">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-10" title="10"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb275-11" title="11"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb275-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb275-13" title="13"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein Consumption&quot;</span>,</a>
<a class="sourceLine" id="cb275-14" title="14">         <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb275-15" title="15"></a>
<a class="sourceLine" id="cb275-16" title="16">cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p><code>plot_grid()</code> has some functionality that’s easier to work with than <code>grid.arrange</code> for some people, so you might want to learn more about it. Check out its web site at <a href="https://wilkelab.org/cowplot/" class="uri">https://wilkelab.org/cowplot/</a>.</p>
</div>
<div id="using-patchwork-to-compose-plots" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Using <code>patchwork</code> to compose plots</h3>
<p>For me, the slickest approach to composing how a series of plots are placed together is available in the <code>patchwork</code> package, which must be installed via Github using <code>devtools</code> at this writing.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb276-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb276-3" title="3"></a>
<a class="sourceLine" id="cb276-4" title="4"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb276-5" title="5"></a>
<a class="sourceLine" id="cb276-6" title="6">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>protein, <span class="dt">data =</span> nnyfs)</a>
<a class="sourceLine" id="cb276-7" title="7">bin_w &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb276-8" title="8"></a>
<a class="sourceLine" id="cb276-9" title="9">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-10" title="10"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb276-11" title="11">                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb276-12" title="12">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-13" title="13"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb276-14" title="14"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb276-15" title="15">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb276-16" title="16">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb276-17" title="17"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb276-18" title="18">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-19" title="19"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb276-20" title="20">         <span class="dt">x =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb276-21" title="21"></a>
<a class="sourceLine" id="cb276-22" title="22"></a>
<a class="sourceLine" id="cb276-23" title="23">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-24" title="24"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb276-25" title="25"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-26" title="26"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb276-27" title="27"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb276-28" title="28">         <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb276-29" title="29"></a>
<a class="sourceLine" id="cb276-30" title="30">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-31" title="31"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb276-32" title="32"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb276-33" title="33">                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-34" title="34"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb276-35" title="35"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb276-36" title="36"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb276-37" title="37">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb276-38" title="38"></a>
<a class="sourceLine" id="cb276-39" title="39">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb276-40" title="40"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;NNYFS Protein Consumption&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>For more on the <code>patchwork</code> package, check out its repository at <a href="https://github.com/thomasp85/patchwork" class="uri">https://github.com/thomasp85/patchwork</a>.</p>
</div>
</div>
<div id="can-we-transform-the-protein-data" class="section level2">
<h2><span class="header-section-number">9.4</span> Can we transform the <code>protein</code> data?</h2>
<p>As we’ve seen, the <code>protein</code> data are right skewed, and all of the values are strictly positive. If we want to use the tools of the Normal distribution to describe these data, we might try taking a step “down” our ladder from power 1 (raw data) to lower powers.</p>
<div id="the-square-root" class="section level3">
<h3><span class="header-section-number">9.4.1</span> The Square Root</h3>
<p>Would a square root applied to the protein data help alleviate that right skew?</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb277-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb277-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb277-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb277-4" title="4"></a>
<a class="sourceLine" id="cb277-5" title="5">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span><span class="kw">sqrt</span>(protein), <span class="dt">data =</span> nnyfs)</a>
<a class="sourceLine" id="cb277-6" title="6">bin_w &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb277-7" title="7"></a>
<a class="sourceLine" id="cb277-8" title="8">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-9" title="9"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb277-10" title="10">                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb277-11" title="11">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb277-13" title="13"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb277-14" title="14">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb277-15" title="15">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-16" title="16"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb277-17" title="17">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb277-19" title="19">         <span class="dt">x =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb277-20" title="20"></a>
<a class="sourceLine" id="cb277-21" title="21"></a>
<a class="sourceLine" id="cb277-22" title="22">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-23" title="23"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb277-24" title="24"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-25" title="25"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb277-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb277-27" title="27">         <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb277-28" title="28"></a>
<a class="sourceLine" id="cb277-29" title="29">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-30" title="30"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb277-31" title="31"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb277-32" title="32">                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-33" title="33"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb277-34" title="34"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb277-35" title="35"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb277-36" title="36">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb277-37" title="37"></a>
<a class="sourceLine" id="cb277-38" title="38">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb277-39" title="39"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Square Root of NNYFS Protein Consumption&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>That looks like a more symmetric distribution, certainly, although we still have some outliers on the right side of the distribution. Should we take another step down the ladder?</p>
</div>
<div id="the-logarithm" class="section level3">
<h3><span class="header-section-number">9.4.2</span> The Logarithm</h3>
<p>We might also try a logarithm of the energy circumference data. We can use either the natural logarithm (log, in R) or the base-10 logarithm (log10, in R) - either will have the same impact on skew.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb278-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb278-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb278-4" title="4"></a>
<a class="sourceLine" id="cb278-5" title="5">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span><span class="kw">log</span>(protein), <span class="dt">data =</span> nnyfs)</a>
<a class="sourceLine" id="cb278-6" title="6">bin_w &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb278-7" title="7"></a>
<a class="sourceLine" id="cb278-8" title="8">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-9" title="9"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb278-10" title="10">                   <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb278-11" title="11">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb278-13" title="13"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb278-14" title="14">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb278-15" title="15">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb278-16" title="16"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb278-17" title="17">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb278-19" title="19">         <span class="dt">x =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb278-20" title="20"></a>
<a class="sourceLine" id="cb278-21" title="21"></a>
<a class="sourceLine" id="cb278-22" title="22">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-23" title="23"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb278-24" title="24"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-25" title="25"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb278-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb278-27" title="27">         <span class="dt">y =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb278-28" title="28"></a>
<a class="sourceLine" id="cb278-29" title="29">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-30" title="30"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb278-31" title="31"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">fill =</span> <span class="st">&quot;salmon&quot;</span>, </a>
<a class="sourceLine" id="cb278-32" title="32">                 <span class="dt">outlier.color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-33" title="33"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb278-34" title="34"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb278-35" title="35"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb278-36" title="36">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Log of Protein Consumption (g)&quot;</span>)</a>
<a class="sourceLine" id="cb278-37" title="37"></a>
<a class="sourceLine" id="cb278-38" title="38">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb278-39" title="39"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Logarithm of NNYFS Protein Consumption&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Now, it looks like we may have gone too far in the other direction. It looks like the square root is a sensible choice to try to improve the fit of a Normal model to the protein consumption data.</p>
</div>
</div>
<div id="what-if-we-considered-all-9-available-transformations" class="section level2">
<h2><span class="header-section-number">9.5</span> What if we considered all 9 available transformations?</h2>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb279-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb279-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb279-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb279-4" title="4"></a>
<a class="sourceLine" id="cb279-5" title="5">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-6" title="6"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-7" title="7"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-8" title="8"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cube (power 3)&quot;</span>,</a>
<a class="sourceLine" id="cb279-10" title="10">         <span class="dt">y =</span> <span class="st">&quot;Protein, Cubed&quot;</span>)</a>
<a class="sourceLine" id="cb279-11" title="11"></a>
<a class="sourceLine" id="cb279-12" title="12">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-13" title="13"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-14" title="14"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-15" title="15"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-16" title="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Square (power 2)&quot;</span>,</a>
<a class="sourceLine" id="cb279-17" title="17">         <span class="dt">y =</span> <span class="st">&quot;Protein, Squared&quot;</span>)</a>
<a class="sourceLine" id="cb279-18" title="18"></a>
<a class="sourceLine" id="cb279-19" title="19">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-20" title="20"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-21" title="21"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-22" title="22"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-23" title="23"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original Data&quot;</span>,</a>
<a class="sourceLine" id="cb279-24" title="24">         <span class="dt">y =</span> <span class="st">&quot;Protein (g)&quot;</span>)</a>
<a class="sourceLine" id="cb279-25" title="25"></a>
<a class="sourceLine" id="cb279-26" title="26"></a>
<a class="sourceLine" id="cb279-27" title="27">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-28" title="28"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-29" title="29"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-30" title="30"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-31" title="31"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sqrt (power 0.5)&quot;</span>,</a>
<a class="sourceLine" id="cb279-32" title="32">         <span class="dt">y =</span> <span class="st">&quot;Square Root of Protein&quot;</span>)</a>
<a class="sourceLine" id="cb279-33" title="33"></a>
<a class="sourceLine" id="cb279-34" title="34">p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(protein))) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-35" title="35"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-36" title="36"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-37" title="37"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-38" title="38"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;log (power 0)&quot;</span>,</a>
<a class="sourceLine" id="cb279-39" title="39">         <span class="dt">y =</span> <span class="st">&quot;Natural Log of Protein&quot;</span>)</a>
<a class="sourceLine" id="cb279-40" title="40"></a>
<a class="sourceLine" id="cb279-41" title="41">p6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> protein<span class="op">^</span>(<span class="fl">0.5</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-42" title="42"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-43" title="43"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-44" title="44"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-45" title="45"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/sqrt (power -0.5)&quot;</span>,</a>
<a class="sourceLine" id="cb279-46" title="46">         <span class="dt">y =</span> <span class="st">&quot;1/Square Root(Protein)&quot;</span>)</a>
<a class="sourceLine" id="cb279-47" title="47"></a>
<a class="sourceLine" id="cb279-48" title="48"></a>
<a class="sourceLine" id="cb279-49" title="49">p7 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-50" title="50"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-51" title="51"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-52" title="52"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-53" title="53"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Inverse (power -1)&quot;</span>,</a>
<a class="sourceLine" id="cb279-54" title="54">         <span class="dt">y =</span> <span class="st">&quot;1/Protein&quot;</span>)</a>
<a class="sourceLine" id="cb279-55" title="55"></a>
<a class="sourceLine" id="cb279-56" title="56">p8 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(protein<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-57" title="57"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-58" title="58"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-59" title="59"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-60" title="60"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Square (power -2)&quot;</span>,</a>
<a class="sourceLine" id="cb279-61" title="61">         <span class="dt">y =</span> <span class="st">&quot;1 /(Protein squared)&quot;</span>)</a>
<a class="sourceLine" id="cb279-62" title="62"></a>
<a class="sourceLine" id="cb279-63" title="63">p9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(protein<span class="op">^</span><span class="dv">3</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-64" title="64"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;salmon&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb279-65" title="65"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-66" title="66"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb279-67" title="67"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Cube (power -3)&quot;</span>,</a>
<a class="sourceLine" id="cb279-68" title="68">         <span class="dt">y =</span> <span class="st">&quot;1/(Protein cubed)&quot;</span>)</a>
<a class="sourceLine" id="cb279-69" title="69"></a>
<a class="sourceLine" id="cb279-70" title="70"></a>
<a class="sourceLine" id="cb279-71" title="71">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5 <span class="op">+</span><span class="st"> </span>p6 <span class="op">+</span><span class="st"> </span>p7 <span class="op">+</span><span class="st"> </span>p8 <span class="op">+</span><span class="st"> </span>p9 <span class="op">+</span></a>
<a class="sourceLine" id="cb279-72" title="72"><span class="st">    </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb279-73" title="73"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Transformations of NNYFS Protein Consumption&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>The square root still appears to be the best choice of transformation here, even after we consider all 8 transformation of the raw data.</p>
</div>
<div id="a-simulated-data-set" class="section level2">
<h2><span class="header-section-number">9.6</span> A Simulated Data Set</h2>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb280-1" title="1"><span class="kw">set.seed</span>(<span class="dv">431</span>); </a>
<a class="sourceLine" id="cb280-2" title="2">data2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample2 =</span> <span class="dv">100</span><span class="op">*</span><span class="kw">rbeta</span>(<span class="dt">n =</span> <span class="dv">125</span>, <span class="dt">shape1 =</span> <span class="dv">5</span>, <span class="dt">shape2 =</span> <span class="dv">2</span>))</a></code></pre></div>
<p>If we’d like to transform these data so as to better approximate a Normal distribution, where should we start? What transformation do you suggest?</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb281-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb281-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb281-4" title="4"></a>
<a class="sourceLine" id="cb281-5" title="5">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2, <span class="dt">data =</span> data2)</a>
<a class="sourceLine" id="cb281-6" title="6">bin_w &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb281-7" title="7"></a>
<a class="sourceLine" id="cb281-8" title="8">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-9" title="9"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb281-10" title="10">                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb281-11" title="11">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb281-13" title="13"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb281-14" title="14">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb281-15" title="15">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb281-16" title="16"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb281-17" title="17">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb281-19" title="19">         <span class="dt">x =</span> <span class="st">&quot;Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb281-20" title="20"></a>
<a class="sourceLine" id="cb281-21" title="21"></a>
<a class="sourceLine" id="cb281-22" title="22">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-23" title="23"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb281-24" title="24"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-25" title="25"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb281-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb281-27" title="27">         <span class="dt">y =</span> <span class="st">&quot;Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb281-28" title="28"></a>
<a class="sourceLine" id="cb281-29" title="29">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-30" title="30"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb281-31" title="31"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb281-32" title="32">                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-33" title="33"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb281-34" title="34"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb281-35" title="35"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb281-36" title="36">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb281-37" title="37"></a>
<a class="sourceLine" id="cb281-38" title="38">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb281-39" title="39"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Simulated Data&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-47-1.png" width="672" /></p>
<p>Given the left skew in the data, it looks like a step up in the ladder is warranted, perhaps by looking at the square of the data?</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb282-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb282-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb282-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb282-4" title="4"></a>
<a class="sourceLine" id="cb282-5" title="5">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2<span class="op">^</span><span class="dv">2</span>, <span class="dt">data =</span> data2)</a>
<a class="sourceLine" id="cb282-6" title="6">bin_w &lt;-<span class="st"> </span><span class="dv">600</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb282-7" title="7"></a>
<a class="sourceLine" id="cb282-8" title="8">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-9" title="9"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb282-10" title="10">                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb282-11" title="11">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb282-13" title="13"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb282-14" title="14">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb282-15" title="15">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb282-16" title="16"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb282-17" title="17">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb282-19" title="19">         <span class="dt">x =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb282-20" title="20"></a>
<a class="sourceLine" id="cb282-21" title="21"></a>
<a class="sourceLine" id="cb282-22" title="22">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-23" title="23"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb282-24" title="24"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-25" title="25"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb282-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb282-27" title="27">         <span class="dt">y =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb282-28" title="28"></a>
<a class="sourceLine" id="cb282-29" title="29">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-30" title="30"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb282-31" title="31"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb282-32" title="32">                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-33" title="33"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb282-34" title="34"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb282-35" title="35"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb282-36" title="36">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb282-37" title="37"></a>
<a class="sourceLine" id="cb282-38" title="38">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb282-39" title="39"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Squared Simulated Data&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Looks like at best a modest improvement. How about cubing the data, instead?</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb283-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb283-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb283-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb283-4" title="4"></a>
<a class="sourceLine" id="cb283-5" title="5">res &lt;-<span class="st"> </span>mosaic<span class="op">::</span><span class="kw">favstats</span>(<span class="op">~</span><span class="st"> </span>sample2<span class="op">^</span><span class="dv">3</span>, <span class="dt">data =</span> data2)</a>
<a class="sourceLine" id="cb283-6" title="6">bin_w &lt;-<span class="st"> </span><span class="dv">100000</span> <span class="co"># specify binwidth</span></a>
<a class="sourceLine" id="cb283-7" title="7"></a>
<a class="sourceLine" id="cb283-8" title="8">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-9" title="9"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> bin_w, </a>
<a class="sourceLine" id="cb283-10" title="10">                   <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb283-11" title="11">                   <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-12" title="12"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb283-13" title="13"><span class="st">    </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb283-14" title="14">        <span class="dt">fun =</span> <span class="cf">function</span>(x) <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> res<span class="op">$</span>mean, </a>
<a class="sourceLine" id="cb283-15" title="15">                                <span class="dt">sd =</span> res<span class="op">$</span>sd) <span class="op">*</span><span class="st"> </span></a>
<a class="sourceLine" id="cb283-16" title="16"><span class="st">            </span>res<span class="op">$</span>n <span class="op">*</span><span class="st"> </span>bin_w,</a>
<a class="sourceLine" id="cb283-17" title="17">        <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-18" title="18"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Histogram with Normal fit&quot;</span>, </a>
<a class="sourceLine" id="cb283-19" title="19">         <span class="dt">x =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# of subjects&quot;</span>)</a>
<a class="sourceLine" id="cb283-20" title="20"></a>
<a class="sourceLine" id="cb283-21" title="21"></a>
<a class="sourceLine" id="cb283-22" title="22">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-23" title="23"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb283-24" title="24"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-25" title="25"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb283-26" title="26"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Q-Q plot&quot;</span>,</a>
<a class="sourceLine" id="cb283-27" title="27">         <span class="dt">y =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb283-28" title="28"></a>
<a class="sourceLine" id="cb283-29" title="29">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-30" title="30"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb283-31" title="31"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.3</span>, <span class="dt">fill =</span> <span class="st">&quot;royalblue&quot;</span>, </a>
<a class="sourceLine" id="cb283-32" title="32">                 <span class="dt">outlier.color =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-33" title="33"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb283-34" title="34"><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb283-35" title="35"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Boxplot with Violin&quot;</span>,</a>
<a class="sourceLine" id="cb283-36" title="36">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</a>
<a class="sourceLine" id="cb283-37" title="37"></a>
<a class="sourceLine" id="cb283-38" title="38">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">-</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb283-39" title="39"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Cubed Simulated Data&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>The newly transformed (cube of the) data appears more symmetric, although somewhat light-tailed. Perhaps a Normal model would be more appropriate now, although the standard deviation is likely to overstate the variation we see in the data due to the light tails. Again, I wouldn’t be thrilled using a cube in practical work, as it is so hard to interpret, but it does look like a reasonable choice here.</p>
<div id="transformation-example-2-ladder-with-normal-q-q-plots" class="section level3">
<h3><span class="header-section-number">9.6.1</span> Transformation Example 2 Ladder with Normal Q-Q Plots</h3>
</div>
</div>
<div id="what-if-we-considered-all-9-available-transformations-1" class="section level2">
<h2><span class="header-section-number">9.7</span> What if we considered all 9 available transformations?</h2>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="co">## must install patchwork from Github using devtools</span></a>
<a class="sourceLine" id="cb284-2" title="2"><span class="co">## with devtools::install_github(&quot;thomasp85/patchwork&quot;)</span></a>
<a class="sourceLine" id="cb284-3" title="3"><span class="co">## library(patchwork)</span></a>
<a class="sourceLine" id="cb284-4" title="4"></a>
<a class="sourceLine" id="cb284-5" title="5">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">3</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-6" title="6"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-7" title="7"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-8" title="8"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cube (power 3)&quot;</span>)</a>
<a class="sourceLine" id="cb284-10" title="10"></a>
<a class="sourceLine" id="cb284-11" title="11">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span><span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-12" title="12"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-13" title="13"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-14" title="14"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-15" title="15"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Square (power 2)&quot;</span>)</a>
<a class="sourceLine" id="cb284-16" title="16"></a>
<a class="sourceLine" id="cb284-17" title="17">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-18" title="18"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-19" title="19"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-20" title="20"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-21" title="21"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Original Data&quot;</span>)</a>
<a class="sourceLine" id="cb284-22" title="22"></a>
<a class="sourceLine" id="cb284-23" title="23">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">sqrt</span>(sample2))) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-24" title="24"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-25" title="25"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-26" title="26"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-27" title="27"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;sqrt (power 0.5)&quot;</span>)</a>
<a class="sourceLine" id="cb284-28" title="28"></a>
<a class="sourceLine" id="cb284-29" title="29">p5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="kw">log</span>(sample2))) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-30" title="30"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-31" title="31"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-32" title="32"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-33" title="33"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;log (power 0)&quot;</span>)</a>
<a class="sourceLine" id="cb284-34" title="34"></a>
<a class="sourceLine" id="cb284-35" title="35">p6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> sample2<span class="op">^</span>(<span class="fl">0.5</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-36" title="36"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-37" title="37"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-38" title="38"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-39" title="39"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/sqrt (power -0.5)&quot;</span>)</a>
<a class="sourceLine" id="cb284-40" title="40"></a>
<a class="sourceLine" id="cb284-41" title="41">p7 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>sample2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-42" title="42"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-43" title="43"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-44" title="44"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-45" title="45"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Inverse (power -1)&quot;</span>)</a>
<a class="sourceLine" id="cb284-46" title="46"></a>
<a class="sourceLine" id="cb284-47" title="47">p8 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(sample2<span class="op">^</span><span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-48" title="48"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-49" title="49"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-50" title="50"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-51" title="51"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Square (power -2)&quot;</span>)</a>
<a class="sourceLine" id="cb284-52" title="52"></a>
<a class="sourceLine" id="cb284-53" title="53">p9 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data2, <span class="kw">aes</span>(<span class="dt">sample =</span> <span class="dv">1</span><span class="op">/</span>(sample2<span class="op">^</span><span class="dv">3</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-54" title="54"><span class="st">    </span><span class="kw">geom_qq</span>(<span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb284-55" title="55"><span class="st">    </span><span class="kw">geom_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-56" title="56"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb284-57" title="57"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1/Cube (power -3)&quot;</span>)</a>
<a class="sourceLine" id="cb284-58" title="58"></a>
<a class="sourceLine" id="cb284-59" title="59"></a>
<a class="sourceLine" id="cb284-60" title="60">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4 <span class="op">+</span><span class="st"> </span>p5 <span class="op">+</span><span class="st"> </span>p6 <span class="op">+</span><span class="st"> </span>p7 <span class="op">+</span><span class="st"> </span>p8 <span class="op">+</span><span class="st"> </span>p9 <span class="op">+</span></a>
<a class="sourceLine" id="cb284-61" title="61"><span class="st">    </span><span class="kw">plot_layout</span>(<span class="dt">nrow =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb284-62" title="62"><span class="st">    </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;Transformations of Simulated Sample&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Again, either the cube or the square looks like best choice here, in terms of creating a more symmetric (albeit light-tailed) distribution.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb285-1" title="1"><span class="kw">rm</span>(p1, p2, p3, p4, p5, p6, p7, p8, p9, res, bin_w, data2)</a></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="assessing-normality.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summarizing-data-within-subgroups.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/09_transformations.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["2019-431-book.pdf", "2019-431-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
