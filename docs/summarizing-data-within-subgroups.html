<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Summarizing data within subgroups | Data Science for Biological, Medical and Health Research: Notes for PQHS 431</title>
  <meta name="description" content="Chapter 10 Summarizing data within subgroups | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Summarizing data within subgroups | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Summarizing data within subgroups | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  
  
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="using-transformations-to-normalize-distributions.html"/>
<link rel="next" href="straight-line-models-and-correlation.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for PQHS 431</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-philosophy"><i class="fa fa-check"></i>Course Philosophy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#working-with-this-document"><i class="fa fa-check"></i>Working with this Document</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#why-a-unicorn"><i class="fa fa-check"></i><b>1.1</b> Why a unicorn?</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-science-project-cycle"><i class="fa fa-check"></i><b>1.2</b> Data Science Project Cycle</a></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#what-will-we-discuss-in-431"><i class="fa fa-check"></i><b>1.3</b> What Will We Discuss in 431?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rsetup.html"><a href="Rsetup.html"><i class="fa fa-check"></i><b>2</b> Setting Up R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rsetup.html"><a href="Rsetup.html#r-markdown"><i class="fa fa-check"></i><b>2.1</b> R Markdown</a></li>
<li class="chapter" data-level="2.2" data-path="Rsetup.html"><a href="Rsetup.html#r-packages"><i class="fa fa-check"></i><b>2.2</b> R Packages</a></li>
<li class="chapter" data-level="2.3" data-path="Rsetup.html"><a href="Rsetup.html#other-packages"><i class="fa fa-check"></i><b>2.3</b> Other Packages</a></li>
</ul></li>
<li class="part"><span><b>Part A. Exploring Data</b></span></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualizing Data</a><ul>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#the-nhanes-data-collecting-a-sample"><i class="fa fa-check"></i><b>3.1</b> The NHANES data: Collecting a Sample</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#age-and-height"><i class="fa fa-check"></i><b>3.2</b> Age and Height</a></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#subset-of-subjects-with-known-age-and-height"><i class="fa fa-check"></i><b>3.3</b> Subset of Subjects with Known Age and Height</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#the-distinction-between-gender-and-sex"><i class="fa fa-check"></i><b>3.3.1</b> The Distinction between <code>Gender</code> and <code>Sex</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#age-height-and-sex"><i class="fa fa-check"></i><b>3.4</b> Age-Height and Sex?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataviz.html"><a href="dataviz.html#can-we-show-the-female-and-male-relationships-in-separate-panels"><i class="fa fa-check"></i><b>3.4.1</b> Can we show the Female and Male relationships in separate panels?</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataviz.html"><a href="dataviz.html#can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot"><i class="fa fa-check"></i><b>3.4.2</b> Can we add a smooth curve to show the relationship in each plot?</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataviz.html"><a href="dataviz.html#what-if-we-want-to-assume-straight-line-relationships"><i class="fa fa-check"></i><b>3.4.3</b> What if we want to assume straight line relationships?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataviz.html"><a href="dataviz.html#a-new-subset-ages-21-79"><i class="fa fa-check"></i><b>3.5</b> A New Subset: Ages 21-79</a></li>
<li class="chapter" data-level="3.6" data-path="dataviz.html"><a href="dataviz.html#distribution-of-heights"><i class="fa fa-check"></i><b>3.6</b> Distribution of Heights</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dataviz.html"><a href="dataviz.html#changing-a-histograms-fill-and-color"><i class="fa fa-check"></i><b>3.6.1</b> Changing a Histogram’s Fill and Color</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dataviz.html"><a href="dataviz.html#height-and-sex"><i class="fa fa-check"></i><b>3.7</b> Height and Sex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="dataviz.html"><a href="dataviz.html#a-boxplot-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.1</b> A Boxplot of Height by Sex</a></li>
<li class="chapter" data-level="3.7.2" data-path="dataviz.html"><a href="dataviz.html#histograms-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.2</b> Histograms of Height by Sex</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="dataviz.html"><a href="dataviz.html#looking-at-pulse-rate"><i class="fa fa-check"></i><b>3.8</b> Looking at Pulse Rate</a><ul>
<li class="chapter" data-level="3.8.1" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-physical-activity"><i class="fa fa-check"></i><b>3.8.1</b> Pulse Rate and Physical Activity</a></li>
<li class="chapter" data-level="3.8.2" data-path="dataviz.html"><a href="dataviz.html#pulse-by-sleeping-trouble"><i class="fa fa-check"></i><b>3.8.2</b> Pulse by Sleeping Trouble</a></li>
<li class="chapter" data-level="3.8.3" data-path="dataviz.html"><a href="dataviz.html#pulse-and-healthgen"><i class="fa fa-check"></i><b>3.8.3</b> Pulse and HealthGen</a></li>
<li class="chapter" data-level="3.8.4" data-path="dataviz.html"><a href="dataviz.html#pulse-rate-and-systolic-blood-pressure"><i class="fa fa-check"></i><b>3.8.4</b> Pulse Rate and Systolic Blood Pressure</a></li>
<li class="chapter" data-level="3.8.5" data-path="dataviz.html"><a href="dataviz.html#sleep-troubls-vs.-no-sleep-trouble"><i class="fa fa-check"></i><b>3.8.5</b> Sleep Troubls vs. No Sleep Trouble?</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="dataviz.html"><a href="dataviz.html#general-health-status"><i class="fa fa-check"></i><b>3.9</b> General Health Status</a><ul>
<li class="chapter" data-level="3.9.1" data-path="dataviz.html"><a href="dataviz.html#bar-chart-for-categorical-data"><i class="fa fa-check"></i><b>3.9.1</b> Bar Chart for Categorical Data</a></li>
<li class="chapter" data-level="3.9.2" data-path="dataviz.html"><a href="dataviz.html#working-with-tables"><i class="fa fa-check"></i><b>3.9.2</b> Working with Tables</a></li>
<li class="chapter" data-level="3.9.3" data-path="dataviz.html"><a href="dataviz.html#sbp-by-general-health-status"><i class="fa fa-check"></i><b>3.9.3</b> SBP by General Health Status</a></li>
<li class="chapter" data-level="3.9.4" data-path="dataviz.html"><a href="dataviz.html#sbp-by-physical-activity-and-general-health-status"><i class="fa fa-check"></i><b>3.9.4</b> SBP by Physical Activity and General Health Status</a></li>
<li class="chapter" data-level="3.9.5" data-path="dataviz.html"><a href="dataviz.html#sbp-by-sleep-trouble-and-general-health-status"><i class="fa fa-check"></i><b>3.9.5</b> SBP by Sleep Trouble and General Health Status</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="dataviz.html"><a href="dataviz.html#conclusions"><i class="fa fa-check"></i><b>3.10</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Data Structures and Types of Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#data-require-structure-and-context"><i class="fa fa-check"></i><b>4.1</b> Data require structure and context</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#createnh_adults"><i class="fa fa-check"></i><b>4.2</b> A New NHANES Adult Sample</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#summarizing-the-datas-structure"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing the Data’s Structure</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#what-are-the-variables"><i class="fa fa-check"></i><b>4.2.2</b> What are the variables?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#types-of-variables"><i class="fa fa-check"></i><b>4.3</b> Types of Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#quantitative-variables"><i class="fa fa-check"></i><b>4.3.1</b> Quantitative Variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#qualitative-categorical-variables"><i class="fa fa-check"></i><b>4.3.2</b> Qualitative (Categorical) Variables</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#creating-a-data-report-quickly"><i class="fa fa-check"></i><b>4.4</b> Creating a Data Report Quickly</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html"><i class="fa fa-check"></i><b>5</b> Summarizing Quantitative Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-summary-function-for-quantitative-data"><i class="fa fa-check"></i><b>5.1</b> The <code>summary</code> function for Quantitative data</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-center-of-a-distribution"><i class="fa fa-check"></i><b>5.2</b> Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mean-and-the-median"><i class="fa fa-check"></i><b>5.2.1</b> The Mean and The Median</a></li>
<li class="chapter" data-level="5.2.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#dealing-with-missingness"><i class="fa fa-check"></i><b>5.2.2</b> Dealing with Missingness</a></li>
<li class="chapter" data-level="5.2.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mode-of-a-quantitative-variable"><i class="fa fa-check"></i><b>5.2.3</b> The Mode of a Quantitative Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-spread-of-a-distribution"><i class="fa fa-check"></i><b>5.3</b> Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#rangeandiqr"><i class="fa fa-check"></i><b>5.3.1</b> The Range and the Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-variance-and-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.2</b> The Variance and the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#obtaining-the-variance-and-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.3.3</b> Obtaining the Variance and Standard Deviation in R</a></li>
<li class="chapter" data-level="5.3.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#defining-the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.3.4</b> Defining the Variance and Standard Deviation</a></li>
<li class="chapter" data-level="5.3.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#empirical-rule-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.5</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.6" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#chebyshevs-inequality-one-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.6</b> Chebyshev’s Inequality: One Interpretation of the Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-shape-of-a-distribution"><i class="fa fa-check"></i><b>5.4</b> Measuring the Shape of a Distribution</a><ul>
<li class="chapter" data-level="5.4.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#multimodal-vs.-unimodal-distributions"><i class="fa fa-check"></i><b>5.4.1</b> Multimodal vs. Unimodal distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skew"><i class="fa fa-check"></i><b>5.4.2</b> Skew</a></li>
<li class="chapter" data-level="5.4.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#kurtosis"><i class="fa fa-check"></i><b>5.4.3</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#more-detailed-numerical-summaries-for-quantitative-variables"><i class="fa fa-check"></i><b>5.5</b> More Detailed Numerical Summaries for Quantitative Variables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#favstats-in-the-mosaic-package"><i class="fa fa-check"></i><b>5.5.1</b> <code>favstats</code> in the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skim-in-the-skimr-package"><i class="fa fa-check"></i><b>5.5.2</b> <code>skim</code> in the <code>skimr</code> package</a></li>
<li class="chapter" data-level="5.5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-psych-package"><i class="fa fa-check"></i><b>5.5.3</b> <code>describe</code> in the <code>psych</code> package</a></li>
<li class="chapter" data-level="5.5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>5.5.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="5.5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#other-options"><i class="fa fa-check"></i><b>5.5.5</b> Other options</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html"><i class="fa fa-check"></i><b>6</b> Summarizing Categorical Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-summary-function-for-categorical-data"><i class="fa fa-check"></i><b>6.1</b> The <code>summary</code> function for Categorical data</a></li>
<li class="chapter" data-level="6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#tables-to-describe-one-categorical-variable"><i class="fa fa-check"></i><b>6.2</b> Tables to describe One Categorical Variable</a></li>
<li class="chapter" data-level="6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-mode-of-a-categorical-variable"><i class="fa fa-check"></i><b>6.3</b> The Mode of a Categorical Variable</a></li>
<li class="chapter" data-level="6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#describe-in-the-hmisc-package-1"><i class="fa fa-check"></i><b>6.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="6.5" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-tabulations"><i class="fa fa-check"></i><b>6.5</b> Cross-Tabulations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-classifying-three-categorical-variables"><i class="fa fa-check"></i><b>6.5.1</b> Cross-Classifying Three Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#constructing-tables-well"><i class="fa fa-check"></i><b>6.6</b> Constructing Tables Well</a><ul>
<li class="chapter" data-level="6.6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#alabama-first"><i class="fa fa-check"></i><b>6.6.1</b> Alabama First!</a></li>
<li class="chapter" data-level="6.6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#order-rows-and-columns-sensibly"><i class="fa fa-check"></i><b>6.6.2</b> Order rows and columns sensibly</a></li>
<li class="chapter" data-level="6.6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#round---a-lot"><i class="fa fa-check"></i><b>6.6.3</b> Round - a lot!</a></li>
<li class="chapter" data-level="6.6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#all-is-different-and-important"><i class="fa fa-check"></i><b>6.6.4</b> ALL is different and important</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="NYFS-Study.html"><a href="NYFS-Study.html"><i class="fa fa-check"></i><b>7</b> NHANES National Youth Fitness Survey (<code>nnyfs</code>)</a><ul>
<li class="chapter" data-level="7.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-variables-included-in-nnyfs"><i class="fa fa-check"></i><b>7.1</b> The Variables included in <code>nnyfs</code></a><ul>
<li class="chapter" data-level="7.1.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-demographic-component"><i class="fa fa-check"></i><b>7.1.1</b> From the <span>NNYFS Demographic Component</span></a></li>
<li class="chapter" data-level="7.1.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-dietary-component"><i class="fa fa-check"></i><b>7.1.2</b> From the <span>NNYFS Dietary Component</span></a></li>
<li class="chapter" data-level="7.1.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-examination-component"><i class="fa fa-check"></i><b>7.1.3</b> From the <span>NNYFS Examination Component</span></a></li>
<li class="chapter" data-level="7.1.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#from-the-nnyfs-questionnaire-component"><i class="fa fa-check"></i><b>7.1.4</b> From the <span>NNYFS Questionnaire Component</span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#looking-over-the-data-set"><i class="fa fa-check"></i><b>7.2</b> Looking over the Data Set</a><ul>
<li class="chapter" data-level="7.2.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#seqn"><i class="fa fa-check"></i><b>7.2.1</b> <code>SEQN</code></a></li>
<li class="chapter" data-level="7.2.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#sex"><i class="fa fa-check"></i><b>7.2.2</b> <code>sex</code></a></li>
<li class="chapter" data-level="7.2.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#age_child"><i class="fa fa-check"></i><b>7.2.3</b> <code>age_child</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#race_eth"><i class="fa fa-check"></i><b>7.2.4</b> <code>race_eth</code></a></li>
<li class="chapter" data-level="7.2.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#income_pov"><i class="fa fa-check"></i><b>7.2.5</b> <code>income_pov</code></a></li>
<li class="chapter" data-level="7.2.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi"><i class="fa fa-check"></i><b>7.2.6</b> <code>bmi</code></a></li>
<li class="chapter" data-level="7.2.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi_cat"><i class="fa fa-check"></i><b>7.2.7</b> <code>bmi_cat</code></a></li>
<li class="chapter" data-level="7.2.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#waist"><i class="fa fa-check"></i><b>7.2.8</b> <code>waist</code></a></li>
<li class="chapter" data-level="7.2.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#triceps_skinfold"><i class="fa fa-check"></i><b>7.2.9</b> <code>triceps_skinfold</code></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#basic-numerical-summaries"><i class="fa fa-check"></i><b>7.3</b> Basic Numerical Summaries</a><ul>
<li class="chapter" data-level="7.3.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-five-number-summary-quantiles-and-iqr"><i class="fa fa-check"></i><b>7.3.1</b> The Five Number Summary, Quantiles and IQR</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#additional-summaries-from-favstats"><i class="fa fa-check"></i><b>7.4</b> Additional Summaries from <code>favstats</code></a></li>
<li class="chapter" data-level="7.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-histogram"><i class="fa fa-check"></i><b>7.5</b> The Histogram</a><ul>
<li class="chapter" data-level="7.5.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#freedman-diaconis-rule-to-select-bin-width"><i class="fa fa-check"></i><b>7.5.1</b> Freedman-Diaconis Rule to select bin width</a></li>
<li class="chapter" data-level="7.5.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-note-on-colors"><i class="fa fa-check"></i><b>7.5.2</b> A Note on Colors</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-stem-and-leaf"><i class="fa fa-check"></i><b>7.6</b> The Stem-and-Leaf</a><ul>
<li class="chapter" data-level="7.6.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-fancier-stem-and-leaf-display"><i class="fa fa-check"></i><b>7.6.1</b> A Fancier Stem-and-Leaf Display</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-dot-plot-to-display-a-distribution"><i class="fa fa-check"></i><b>7.7</b> The Dot Plot to display a distribution</a></li>
<li class="chapter" data-level="7.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-frequency-polygon"><i class="fa fa-check"></i><b>7.8</b> The Frequency Polygon</a></li>
<li class="chapter" data-level="7.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#plotting-the-probability-density-function"><i class="fa fa-check"></i><b>7.9</b> Plotting the Probability Density Function</a></li>
<li class="chapter" data-level="7.10" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-boxplot"><i class="fa fa-check"></i><b>7.10</b> The Boxplot</a><ul>
<li class="chapter" data-level="7.10.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#drawing-a-boxplot-for-one-variable-in-ggplot2"><i class="fa fa-check"></i><b>7.10.1</b> Drawing a Boxplot for One Variable in <code>ggplot2</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#about-the-boxplot"><i class="fa fa-check"></i><b>7.10.2</b> About the Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-simple-comparison-boxplot"><i class="fa fa-check"></i><b>7.11</b> A Simple Comparison Boxplot</a></li>
<li class="chapter" data-level="7.12" data-path="NYFS-Study.html"><a href="NYFS-Study.html#using-describe-in-the-psych-library"><i class="fa fa-check"></i><b>7.12</b> Using <code>describe</code> in the <code>psych</code> library</a><ul>
<li class="chapter" data-level="7.12.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-trimmed-mean"><i class="fa fa-check"></i><b>7.12.1</b> The Trimmed Mean</a></li>
<li class="chapter" data-level="7.12.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-median-absolute-deviation"><i class="fa fa-check"></i><b>7.12.2</b> The Median Absolute Deviation</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-skew"><i class="fa fa-check"></i><b>7.13</b> Assessing Skew</a><ul>
<li class="chapter" data-level="7.13.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#non-parametric-skew-via-skew1"><i class="fa fa-check"></i><b>7.13.1</b> Non-parametric Skew via skew<sub>1</sub></a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-kurtosis-heavy-tailedness"><i class="fa fa-check"></i><b>7.14</b> Assessing Kurtosis (Heavy-Tailedness)</a><ul>
<li class="chapter" data-level="7.14.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-standard-error-of-the-sample-mean"><i class="fa fa-check"></i><b>7.14.1</b> The Standard Error of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-describe-function-in-the-hmisc-library"><i class="fa fa-check"></i><b>7.15</b> The <code>describe</code> function in the <code>Hmisc</code> library</a></li>
<li class="chapter" data-level="7.16" data-path="NYFS-Study.html"><a href="NYFS-Study.html#xda-from-github-for-numerical-summaries-for-exploratory-data-analysis"><i class="fa fa-check"></i><b>7.16</b> <code>xda</code> from GitHub for numerical summaries for exploratory data analysis</a></li>
<li class="chapter" data-level="7.17" data-path="NYFS-Study.html"><a href="NYFS-Study.html#what-summaries-to-report"><i class="fa fa-check"></i><b>7.17</b> What Summaries to Report</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="assessing-normality.html"><a href="assessing-normality.html"><i class="fa fa-check"></i><b>8</b> Assessing Normality</a><ul>
<li class="chapter" data-level="8.1" data-path="assessing-normality.html"><a href="assessing-normality.html#empirical-rule-interpretation-of-the-standard-deviation-1"><i class="fa fa-check"></i><b>8.1</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="8.2" data-path="assessing-normality.html"><a href="assessing-normality.html#describing-outlying-values-with-z-scores"><i class="fa fa-check"></i><b>8.2</b> Describing Outlying Values with Z Scores</a><ul>
<li class="chapter" data-level="8.2.1" data-path="assessing-normality.html"><a href="assessing-normality.html#fences-and-z-scores"><i class="fa fa-check"></i><b>8.2.1</b> Fences and Z Scores</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="assessing-normality.html"><a href="assessing-normality.html#comparing-a-histogram-to-a-normal-distribution"><i class="fa fa-check"></i><b>8.3</b> Comparing a Histogram to a Normal Distribution</a><ul>
<li class="chapter" data-level="8.3.1" data-path="assessing-normality.html"><a href="assessing-normality.html#histogram-of-energy-with-normal-model-with-counts"><i class="fa fa-check"></i><b>8.3.1</b> Histogram of <code>energy</code> with Normal model (with Counts)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="assessing-normality.html"><a href="assessing-normality.html#does-a-normal-model-work-well-for-the-waist-circumference"><i class="fa fa-check"></i><b>8.4</b> Does a Normal model work well for the <code>waist</code> circumference?</a></li>
<li class="chapter" data-level="8.5" data-path="assessing-normality.html"><a href="assessing-normality.html#the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.5</b> The Normal Q-Q Plot</a></li>
<li class="chapter" data-level="8.6" data-path="assessing-normality.html"><a href="assessing-normality.html#interpreting-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6</b> Interpreting the Normal Q-Q Plot</a><ul>
<li class="chapter" data-level="8.6.1" data-path="assessing-normality.html"><a href="assessing-normality.html#data-from-a-normal-distribution-shows-up-as-a-straight-line-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.1</b> Data from a Normal distribution shows up as a straight line in a Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.2" data-path="assessing-normality.html"><a href="assessing-normality.html#skew-is-indicated-by-monotonic-curves-in-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.2</b> Skew is indicated by monotonic curves in the Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.3" data-path="assessing-normality.html"><a href="assessing-normality.html#direction-of-skew"><i class="fa fa-check"></i><b>8.6.3</b> Direction of Skew</a></li>
<li class="chapter" data-level="8.6.4" data-path="assessing-normality.html"><a href="assessing-normality.html#outlier-proneness-is-indicated-by-s-shaped-curves-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.4</b> Outlier-proneness is indicated by “s-shaped” curves in a Normal Q-Q plot</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="assessing-normality.html"><a href="assessing-normality.html#can-a-normal-distribution-fit-the-nnyfs-energy-data-well"><i class="fa fa-check"></i><b>8.7</b> Can a Normal Distribution Fit the <code>nnyfs</code> <code>energy</code> data Well?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html"><i class="fa fa-check"></i><b>9</b> Using Transformations to “Normalize” Distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-ladder-of-power-transformations"><i class="fa fa-check"></i><b>9.1</b> The Ladder of Power Transformations</a></li>
<li class="chapter" data-level="9.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-the-ladder"><i class="fa fa-check"></i><b>9.2</b> Using the Ladder</a></li>
<li class="chapter" data-level="9.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#protein-consumption-in-the-nnyfs-data"><i class="fa fa-check"></i><b>9.3</b> Protein Consumption in the NNYFS data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-cowplotplot_grid-to-compose-plots"><i class="fa fa-check"></i><b>9.3.1</b> Using <code>cowplot::plot_grid()</code> to compose plots</a></li>
<li class="chapter" data-level="9.3.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-patchwork-to-compose-plots"><i class="fa fa-check"></i><b>9.3.2</b> Using <code>patchwork</code> to compose plots</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#can-we-transform-the-protein-data"><i class="fa fa-check"></i><b>9.4</b> Can we transform the <code>protein</code> data?</a><ul>
<li class="chapter" data-level="9.4.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-square-root"><i class="fa fa-check"></i><b>9.4.1</b> The Square Root</a></li>
<li class="chapter" data-level="9.4.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-logarithm"><i class="fa fa-check"></i><b>9.4.2</b> The Logarithm</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations"><i class="fa fa-check"></i><b>9.5</b> What if we considered all 9 available transformations?</a></li>
<li class="chapter" data-level="9.6" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#a-simulated-data-set"><i class="fa fa-check"></i><b>9.6</b> A Simulated Data Set</a><ul>
<li class="chapter" data-level="9.6.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#transformation-example-2-ladder-with-normal-q-q-plots"><i class="fa fa-check"></i><b>9.6.1</b> Transformation Example 2 Ladder with Normal Q-Q Plots</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#what-if-we-considered-all-9-available-transformations-1"><i class="fa fa-check"></i><b>9.7</b> What if we considered all 9 available transformations?</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html"><i class="fa fa-check"></i><b>10</b> Summarizing data within subgroups</a><ul>
<li class="chapter" data-level="10.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-dplyr-and-summarise-to-build-a-tibble-of-summary-information"><i class="fa fa-check"></i><b>10.1</b> Using dplyr and summarise to build a tibble of summary information</a></li>
<li class="chapter" data-level="10.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#another-example"><i class="fa fa-check"></i><b>10.2</b> Another Example</a></li>
<li class="chapter" data-level="10.3" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#boxplots-to-relate-an-outcome-to-a-categorical-predictor"><i class="fa fa-check"></i><b>10.3</b> Boxplots to Relate an Outcome to a Categorical Predictor</a><ul>
<li class="chapter" data-level="10.3.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#augmenting-the-boxplot-with-the-sample-mean"><i class="fa fa-check"></i><b>10.3.1</b> Augmenting the Boxplot with the Sample Mean</a></li>
<li class="chapter" data-level="10.3.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#adding-notches-to-a-boxplot"><i class="fa fa-check"></i><b>10.3.2</b> Adding Notches to a Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-histograms-to-make-comparisons"><i class="fa fa-check"></i><b>10.4</b> Using Multiple Histograms to Make Comparisons</a></li>
<li class="chapter" data-level="10.5" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-density-plots-to-make-comparisons"><i class="fa fa-check"></i><b>10.5</b> Using Multiple Density Plots to Make Comparisons</a></li>
<li class="chapter" data-level="10.6" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#building-a-violin-plot"><i class="fa fa-check"></i><b>10.6</b> Building a Violin Plot</a></li>
<li class="chapter" data-level="10.7" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#a-ridgeline-plot"><i class="fa fa-check"></i><b>10.7</b> A Ridgeline Plot</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html"><i class="fa fa-check"></i><b>11</b> Straight Line Models and Correlation</a><ul>
<li class="chapter" data-level="11.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#assessing-a-scatterplot"><i class="fa fa-check"></i><b>11.1</b> Assessing A Scatterplot</a><ul>
<li class="chapter" data-level="11.1.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#highlighting-an-unusual-point"><i class="fa fa-check"></i><b>11.1.1</b> Highlighting an unusual point</a></li>
<li class="chapter" data-level="11.1.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#adding-a-scatterplot-smooth-using-loess"><i class="fa fa-check"></i><b>11.1.2</b> Adding a Scatterplot Smooth using loess</a></li>
<li class="chapter" data-level="11.1.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#what-line-does-r-fit"><i class="fa fa-check"></i><b>11.1.3</b> What Line Does R Fit?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlation-coefficients"><i class="fa fa-check"></i><b>11.2</b> Correlation Coefficients</a></li>
<li class="chapter" data-level="11.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>11.3</b> The Pearson Correlation Coefficient</a></li>
<li class="chapter" data-level="11.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#a-simulated-example"><i class="fa fa-check"></i><b>11.4</b> A simulated example</a><ul>
<li class="chapter" data-level="11.4.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-alex"><i class="fa fa-check"></i><b>11.4.1</b> Data Set Alex</a></li>
<li class="chapter" data-level="11.4.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-bonnie"><i class="fa fa-check"></i><b>11.4.2</b> Data Set Bonnie</a></li>
<li class="chapter" data-level="11.4.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlations-for-all-six-data-sets-in-the-correx1-example"><i class="fa fa-check"></i><b>11.4.3</b> Correlations for All Six Data Sets in the Correx1 Example</a></li>
<li class="chapter" data-level="11.4.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-colin"><i class="fa fa-check"></i><b>11.4.4</b> Data Set Colin</a></li>
<li class="chapter" data-level="11.4.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#draw-the-picture"><i class="fa fa-check"></i><b>11.4.5</b> Draw the Picture!</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#estimating-correlation-from-scatterplots"><i class="fa fa-check"></i><b>11.5</b> Estimating Correlation from Scatterplots</a></li>
<li class="chapter" data-level="11.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-spearman-rank-correlation"><i class="fa fa-check"></i><b>11.6</b> The Spearman Rank Correlation</a><ul>
<li class="chapter" data-level="11.6.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-formula"><i class="fa fa-check"></i><b>11.6.1</b> Spearman Formula</a></li>
<li class="chapter" data-level="11.6.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#comparing-pearson-and-spearman-correlations"><i class="fa fa-check"></i><b>11.6.2</b> Comparing Pearson and Spearman Correlations</a></li>
<li class="chapter" data-level="11.6.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-1"><i class="fa fa-check"></i><b>11.6.3</b> Spearman vs. Pearson Example 1</a></li>
<li class="chapter" data-level="11.6.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-2"><i class="fa fa-check"></i><b>11.6.4</b> Spearman vs. Pearson Example 2</a></li>
<li class="chapter" data-level="11.6.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-3"><i class="fa fa-check"></i><b>11.6.5</b> Spearman vs. Pearson Example 3</a></li>
<li class="chapter" data-level="11.6.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-4"><i class="fa fa-check"></i><b>11.6.6</b> Spearman vs. Pearson Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="this-is-work-in-progress.html"><a href="this-is-work-in-progress.html"><i class="fa fa-check"></i>This is Work in Progress</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for PQHS 431</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="summarizing-data-within-subgroups" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Summarizing data within subgroups</h1>
<div id="using-dplyr-and-summarise-to-build-a-tibble-of-summary-information" class="section level2">
<h2><span class="header-section-number">10.1</span> Using dplyr and summarise to build a tibble of summary information</h2>
<p>Suppose we want to understand how the subjects whose diet involved consuming much more than usual yesterday compare to those who consumer their usual amount, or to those who consumed much less than usual, in terms of the energy they consumed, as well as the protein. We might start by looking at the medians and means.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb286-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(diet_yesterday) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="st">    </span><span class="kw">select</span>(diet_yesterday, energy, protein) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb286-4" title="4"><span class="st">    </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(median, mean))</a></code></pre></div>
<pre><code>Warning: funs() is soft deprecated as of dplyr 0.8.0
Please use a list of either functions or lambdas: 

  # Simple named list: 
  list(mean = mean, median = median)

  # Auto named with `tibble::lst()`: 
  tibble::lst(mean, median)

  # Using lambdas
  list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
This warning is displayed once per session.</code></pre>
<pre><code># A tibble: 4 x 5
  diet_yesterday      energy_median protein_median energy_mean protein_mean
  &lt;chr&gt;                       &lt;dbl&gt;          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 1_Much more than u~          2098           69.4       2150.         75.1
2 2_Usual                      1794           61.3       1858.         67.0
3 3_Much less than u~          1643           53.9       1779.         60.1
4 &lt;NA&gt;                         4348          155.        4348         155. </code></pre>
<p>Perhaps we should restrict ourselves to the people who were not missing the <code>diet_yesterday</code> category, and look now at their <code>sugar</code> and <code>water</code> consumption.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb289-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb289-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(diet_yesterday)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb289-3" title="3"><span class="st">    </span><span class="kw">group_by</span>(diet_yesterday) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb289-4" title="4"><span class="st">    </span><span class="kw">select</span>(diet_yesterday, energy, protein, sugar, water) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb289-5" title="5"><span class="st">    </span><span class="kw">summarise_all</span>(<span class="kw">funs</span>(median))</a></code></pre></div>
<pre><code># A tibble: 3 x 5
  diet_yesterday         energy protein sugar water
  &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1_Much more than usual   2098    69.4  137.  500 
2 2_Usual                  1794    61.3  114.  385.
3 3_Much less than usual   1643    53.9  115.  311.</code></pre>
<p>It looks like the children in the “Much more than usual” category consumed more energy, protein, sugar and water than the children in the other two categories. Let’s draw a picture of this.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">library</span>(patchwork) </a>
<a class="sourceLine" id="cb291-2" title="2"></a>
<a class="sourceLine" id="cb291-3" title="3">temp_dat &lt;-<span class="st"> </span>nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb291-4" title="4"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(diet_yesterday)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb291-5" title="5"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">diet_yesterday =</span> <span class="kw">fct_recode</span>(diet_yesterday,</a>
<a class="sourceLine" id="cb291-6" title="6">        <span class="st">&quot;Much more&quot;</span> =<span class="st"> &quot;1_Much more than usual&quot;</span>,</a>
<a class="sourceLine" id="cb291-7" title="7">        <span class="st">&quot;Usual diet&quot;</span> =<span class="st"> &quot;2_Usual&quot;</span>,</a>
<a class="sourceLine" id="cb291-8" title="8">        <span class="st">&quot;Much less&quot;</span> =<span class="st"> &quot;3_Much less than usual&quot;</span>))</a>
<a class="sourceLine" id="cb291-9" title="9"></a>
<a class="sourceLine" id="cb291-10" title="10">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(temp_dat, <span class="kw">aes</span>(<span class="dt">x =</span> diet_yesterday, <span class="dt">y =</span> energy)) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-11" title="11"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-12" title="12"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> diet_yesterday), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-13" title="13"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-14" title="14"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-15" title="15"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-16" title="16"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Energy Comparison&quot;</span>)</a>
<a class="sourceLine" id="cb291-17" title="17"></a>
<a class="sourceLine" id="cb291-18" title="18">p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(temp_dat, <span class="kw">aes</span>(<span class="dt">x =</span> diet_yesterday, <span class="dt">y =</span> protein)) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-19" title="19"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-20" title="20"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> diet_yesterday), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-21" title="21"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-22" title="22"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-23" title="23"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-24" title="24"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Protein Comparison&quot;</span>)</a>
<a class="sourceLine" id="cb291-25" title="25"></a>
<a class="sourceLine" id="cb291-26" title="26">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(temp_dat, <span class="kw">aes</span>(<span class="dt">x =</span> diet_yesterday, <span class="dt">y =</span> sugar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-27" title="27"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-28" title="28"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> diet_yesterday), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-29" title="29"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-30" title="30"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-31" title="31"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-32" title="32"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Sugar Comparison&quot;</span>)</a>
<a class="sourceLine" id="cb291-33" title="33"></a>
<a class="sourceLine" id="cb291-34" title="34">p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(temp_dat, <span class="kw">aes</span>(<span class="dt">x =</span> diet_yesterday, <span class="dt">y =</span> water)) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-35" title="35"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-36" title="36"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> diet_yesterday), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-37" title="37"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb291-38" title="38"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb291-39" title="39"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-40" title="40"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Water Comparison&quot;</span>)</a>
<a class="sourceLine" id="cb291-41" title="41"></a>
<a class="sourceLine" id="cb291-42" title="42">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span>p4</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>We can see that there is considerable overlap in these distributions, regardless of what we’re measuring.</p>
</div>
<div id="another-example" class="section level2">
<h2><span class="header-section-number">10.2</span> Another Example</h2>
<p>Suppose now that we ask a different question. Do kids in larger categories of BMI have larger waist circumferences?</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb292-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(bmi_cat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb292-3" title="3"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(waist), <span class="dt">sd =</span> <span class="kw">sd</span>(waist), </a>
<a class="sourceLine" id="cb292-4" title="4">              <span class="dt">median =</span> <span class="kw">median</span>(waist), </a>
<a class="sourceLine" id="cb292-5" title="5">              <span class="dt">skew_1 =</span> <span class="kw">round</span>((<span class="kw">mean</span>(waist) <span class="op">-</span><span class="st"> </span><span class="kw">median</span>(waist)) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb292-6" title="6"><span class="st">                                 </span><span class="kw">sd</span>(waist),<span class="dv">2</span>))</a></code></pre></div>
<pre><code># A tibble: 5 x 5
  bmi_cat        mean     sd median skew_1
  &lt;chr&gt;         &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 1_Underweight  55.2   7.58   54.5   0.09
2 2_Normal       NA   NaN      NA    NA   
3 3_Overweight   72.3  11.9    74    -0.14
4 4_Obese        NA   NaN      NA    NA   
5 &lt;NA&gt;           NA   NaN      NA    NA   </code></pre>
<p>Oops. Looks like we need to filter for cases with complete data on both BMI category and waist circumference in order to get meaningful results. We should add a count, too.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb294-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, waist)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb294-3" title="3"><span class="st">    </span><span class="kw">group_by</span>(bmi_cat) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb294-4" title="4"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>(), <span class="dt">mean =</span> <span class="kw">mean</span>(waist), </a>
<a class="sourceLine" id="cb294-5" title="5">              <span class="dt">sd =</span> <span class="kw">sd</span>(waist), <span class="dt">median =</span> <span class="kw">median</span>(waist), </a>
<a class="sourceLine" id="cb294-6" title="6">       <span class="dt">skew_1 =</span> </a>
<a class="sourceLine" id="cb294-7" title="7">         <span class="kw">round</span>((<span class="kw">mean</span>(waist) <span class="op">-</span><span class="st"> </span><span class="kw">median</span>(waist)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(waist),<span class="dv">2</span>))</a></code></pre></div>
<pre><code># A tibble: 4 x 6
  bmi_cat       count  mean    sd median skew_1
  &lt;chr&gt;         &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 1_Underweight    41  55.2  7.58   54.5   0.09
2 2_Normal        917  61.2  9.35   59.5   0.19
3 3_Overweight    258  72.3 11.9    74    -0.14
4 4_Obese         294  85.6 17.1    86.8  -0.07</code></pre>
<p>Or, we could use something like <code>favstats</code> from the <code>mosaic</code> package, which automatically accounts for missing data, and omits it when calculating summary statistics within each group.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1">mosaic<span class="op">::</span><span class="kw">favstats</span>(waist <span class="op">~</span><span class="st"> </span>bmi_cat, <span class="dt">data =</span> nnyfs)</a></code></pre></div>
<pre><code>        bmi_cat  min   Q1 median   Q3   max mean    sd   n missing
1 1_Underweight 42.5 49.3   54.5 62.4  68.5 55.2  7.58  41       0
2      2_Normal 44.1 53.9   59.5 68.4  89.2 61.2  9.35 917       3
3  3_Overweight 49.3 62.3   74.0 81.2 105.3 72.3 11.94 258       0
4       4_Obese 52.1 72.7   86.8 96.8 144.7 85.6 17.11 294       1</code></pre>
<p>While patients in the heavier groups generally had higher waist circumferences, the standard deviations suggest there may be some meaningful overlap. Let’s draw the picture, in this case a comparison boxplot accompanying a violin plot.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, waist)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> waist)) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-4" title="4"><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb298-5" title="5"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> bmi_cat), <span class="dt">width =</span> <span class="fl">0.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-6" title="6"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb298-7" title="7"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb298-8" title="8"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb298-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Waist Circumference by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>The data transformation with dplyr cheat sheet found under the Help menu in RStudio is a great resource. And, of course, for more details, visit <span class="citation">Grolemund and Wickham (<a href="#ref-R4DS">2019</a>)</span>.</p>
</div>
<div id="boxplots-to-relate-an-outcome-to-a-categorical-predictor" class="section level2">
<h2><span class="header-section-number">10.3</span> Boxplots to Relate an Outcome to a Categorical Predictor</h2>
<p>Boxplots are much more useful when comparing samples of data. For instance, consider this comparison boxplot describing the triceps skinfold results across the four levels of BMI category.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="kw">ggplot</span>(nnyfs, <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> triceps_skinfold,</a>
<a class="sourceLine" id="cb299-2" title="2">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb299-3" title="3"><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb299-4" title="4"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb299-5" title="5"><span class="st">    </span><span class="kw">theme_light</span>()</a></code></pre></div>
<pre><code>Warning: Removed 21 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>Again, we probably want to omit those missing values (both in <code>bmi_cat</code> and <code>triceps_skinfold</code>) and also eliminate the repetitive legend (guides) on the right.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb301-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb301-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, triceps_skinfold)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb301-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> triceps_skinfold,</a>
<a class="sourceLine" id="cb301-4" title="4">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb301-5" title="5"><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb301-6" title="6"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb301-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb301-8" title="8"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb301-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;BMI Category&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Triceps Skinfold in mm&quot;</span>,</a>
<a class="sourceLine" id="cb301-10" title="10">         <span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold increases with BMI category&quot;</span>,</a>
<a class="sourceLine" id="cb301-11" title="11">         <span class="dt">subtitle =</span> <span class="st">&quot;NNYFS children&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>As always, the boxplot shows the five-number summary (minimum, 25th percentile, median, 75th percentile and maximum) in addition to highlighting candidate outliers.</p>
<div id="augmenting-the-boxplot-with-the-sample-mean" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Augmenting the Boxplot with the Sample Mean</h3>
<p>Often, we want to augment such a plot, perhaps by adding a little diamond to show the <strong>sample mean</strong> within each category, so as to highlight skew (in terms of whether the mean is meaningfully different from the median.)</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb302-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, triceps_skinfold)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb302-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> triceps_skinfold,</a>
<a class="sourceLine" id="cb302-4" title="4">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb302-5" title="5"><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb302-6" title="6"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, </a>
<a class="sourceLine" id="cb302-7" title="7">                 <span class="dt">shape=</span><span class="dv">23</span>, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb302-8" title="8"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb302-9" title="9"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb302-10" title="10"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb302-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;BMI Category&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Triceps Skinfold in mm&quot;</span>,</a>
<a class="sourceLine" id="cb302-12" title="12">         <span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold increases with BMI category&quot;</span>,</a>
<a class="sourceLine" id="cb302-13" title="13">         <span class="dt">subtitle =</span> <span class="st">&quot;NNYFS children&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
</div>
<div id="adding-notches-to-a-boxplot" class="section level3">
<h3><span class="header-section-number">10.3.2</span> Adding Notches to a Boxplot</h3>
<p><strong>Notches</strong> are used in boxplots to help visually assess whether the medians of the distributions across the various groups actually differ to a statistically detectable extent Think of them as confidence regions around the medians. If the notches do not overlap, as in this situation, this provides some evidence that the medians in the populations represented by these samples may be different.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, triceps_skinfold)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb303-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> triceps_skinfold,</a>
<a class="sourceLine" id="cb303-4" title="4">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-5" title="5"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">notch =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-6" title="6"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb303-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-8" title="8"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb303-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;BMI Category&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Triceps Skinfold in mm&quot;</span>,</a>
<a class="sourceLine" id="cb303-10" title="10">         <span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold increases with BMI category&quot;</span>,</a>
<a class="sourceLine" id="cb303-11" title="11">         <span class="dt">subtitle =</span> <span class="st">&quot;NNYFS children&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>There is no overlap between the notches for each of the four categories, so we might reasonably conclude that the true median triceps skinfold values across the four categories are statistically significantly different.</p>
<p>For an example where the notches do overlap, consider the comparison of plank times by BMI category.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, plank_time)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb304-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>bmi_cat, <span class="dt">y=</span>plank_time, <span class="dt">fill=</span>bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb304-4" title="4"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">notch=</span><span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb304-5" title="5"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb304-6" title="6"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb304-7" title="7"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb304-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Plank Times by BMI category&quot;</span>, </a>
<a class="sourceLine" id="cb304-9" title="9">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Plank Time (in seconds)&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>The overlap in the notches (for instance between Underweight and Normal) suggests that the median plank times in the population of interest don’t necessarily differ in a meaningful way by BMI category, other than perhaps the Obese group which may have a shorter time.</p>
<p>These data are somewhat right skewed. Would a logarithmic transformation in the plot help us see the patterns more clearly?</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, plank_time)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb305-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>bmi_cat, <span class="dt">y =</span> <span class="kw">log</span>(plank_time), <span class="dt">fill=</span>bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb305-4" title="4"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">notch=</span><span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb305-5" title="5"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-7" title="7"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb305-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;log(Plank Times) by BMI category&quot;</span>, </a>
<a class="sourceLine" id="cb305-9" title="9">         <span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Natural Log of Plank Time&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
</div>
<div id="using-multiple-histograms-to-make-comparisons" class="section level2">
<h2><span class="header-section-number">10.4</span> Using Multiple Histograms to Make Comparisons</h2>
<p>We can make an array of histograms to describe multiple groups of data, using <code>ggplot2</code> and the notion of <strong>faceting</strong> our plot.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(triceps_skinfold, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb306-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>triceps_skinfold, <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb306-4" title="4"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-5" title="5"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>bmi_cat) <span class="op">+</span></a>
<a class="sourceLine" id="cb306-6" title="6"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb306-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb306-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
</div>
<div id="using-multiple-density-plots-to-make-comparisons" class="section level2">
<h2><span class="header-section-number">10.5</span> Using Multiple Density Plots to Make Comparisons</h2>
<p>Or, we can make a series of density plots to describe multiple groups of data.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(triceps_skinfold, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb307-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>triceps_skinfold, <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-4" title="4"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-5" title="5"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>bmi_cat) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-6" title="6"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb307-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>Or, we can plot all of the densities on top of each other with semi-transparent fills.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb308-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(triceps_skinfold, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb308-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>triceps_skinfold, <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span></a>
<a class="sourceLine" id="cb308-4" title="4"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb308-5" title="5"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb308-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>This really works better when we are comparing only two groups, like females to males.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(triceps_skinfold, sex)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb309-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>triceps_skinfold, <span class="dt">fill =</span> sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb309-4" title="4"><span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-5" title="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold by Sex&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
<div id="building-a-violin-plot" class="section level2">
<h2><span class="header-section-number">10.6</span> Building a Violin Plot</h2>
<p>There are a number of other plots which compare distributions of data sets. An interesting one is called a <strong>violin plot</strong>. A violin plot is a kernel density estimate, mirrored to form a symmetrical shape.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb310-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(triceps_skinfold, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb310-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x=</span>bmi_cat, <span class="dt">y=</span>triceps_skinfold, </a>
<a class="sourceLine" id="cb310-4" title="4">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb310-5" title="5"><span class="st">    </span><span class="kw">geom_violin</span>(<span class="dt">trim=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-6" title="6"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb310-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Triceps Skinfold by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>Traditionally, these plots are shown with overlaid boxplots and a white dot at the median, like this example, now looking at waist circumference again.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(waist, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb311-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> bmi_cat, <span class="dt">y =</span> waist, </a>
<a class="sourceLine" id="cb311-4" title="4">                  <span class="dt">fill =</span> bmi_cat)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-5" title="5"><span class="st">    </span><span class="kw">geom_violin</span>(<span class="dt">trim=</span><span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb311-6" title="6"><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width=</span>.<span class="dv">1</span>, <span class="dt">outlier.colour=</span><span class="ot">NA</span>, </a>
<a class="sourceLine" id="cb311-7" title="7">                 <span class="dt">color =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;white&quot;</span>,<span class="dv">2</span>), <span class="kw">rep</span>(<span class="st">&quot;black&quot;</span>,<span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb311-8" title="8"><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>median, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, </a>
<a class="sourceLine" id="cb311-9" title="9">                 <span class="dt">fill=</span><span class="st">&quot;white&quot;</span>, <span class="dt">shape=</span><span class="dv">21</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb311-10" title="10"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb311-11" title="11"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb311-12" title="12"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Waist Circumference by BMI Category&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="a-ridgeline-plot" class="section level2">
<h2><span class="header-section-number">10.7</span> A Ridgeline Plot</h2>
<p>Some people don’t like violin plots - for example, see <a href="https://simplystatistics.org/2017/07/13/the-joy-of-no-more-violin-plots/" class="uri">https://simplystatistics.org/2017/07/13/the-joy-of-no-more-violin-plots/</a>. A relatively new alternative plot is available. This shows the distribution of several groups simultaneously, especially when you have lots of subgroup categories, and is called a <strong>ridgeline plot</strong><a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1">nnyfs <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(waist, bmi_cat)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-3" title="3"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> waist, <span class="dt">y =</span> bmi_cat, <span class="dt">height =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb312-4" title="4"><span class="st">    </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="fl">0.85</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb312-5" title="5"><span class="st">    </span><span class="kw">theme_light</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb312-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Ridgeline Plot of Waist Circumference by BMI category (nnyfs)&quot;</span>,</a>
<a class="sourceLine" id="cb312-7" title="7">         <span class="dt">x =</span> <span class="st">&quot;Waist Circumference&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BMI Category&quot;</span>)</a></code></pre></div>
<pre><code>Picking joint bandwidth of 3.47</code></pre>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<p>And here’s a ridgeline plot for the triceps skinfolds. We’ll start by sorting the subgroups by the median value of our outcome (triceps skinfold) in this case, though it turns out not to matter. We’ll also add some color.</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb314-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, triceps_skinfold)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb314-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">bmi_cat =</span> <span class="kw">fct_reorder</span>(bmi_cat,</a>
<a class="sourceLine" id="cb314-4" title="4">                                 triceps_skinfold, </a>
<a class="sourceLine" id="cb314-5" title="5">                                 <span class="dt">.fun =</span> median)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb314-6" title="6"><span class="st">    </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> triceps_skinfold, <span class="dt">y =</span> bmi_cat, </a>
<a class="sourceLine" id="cb314-7" title="7">                  <span class="dt">fill =</span> bmi_cat, <span class="dt">height =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-8" title="8"><span class="st">    </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="fl">0.85</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb314-9" title="9"><span class="st">    </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;magma&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-10" title="10"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-11" title="11"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Ridgeline Plot of Triceps Skinfold by BMI Category (nnyfs)&quot;</span>,</a>
<a class="sourceLine" id="cb314-12" title="12">         <span class="dt">x =</span> <span class="st">&quot;Triceps Skinfold&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BMI Category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-13" title="13"><span class="st">    </span><span class="kw">theme_light</span>()</a></code></pre></div>
<pre><code>Picking joint bandwidth of 1.37</code></pre>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p>For one last example, we’ll look at age by BMI category, so that sorting the BMI subgroups by the median matters, and we’ll try an alternate color scheme, and a theme specially designed for the ridgeline plot.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1">nnyfs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-2" title="2"><span class="st">    </span><span class="kw">filter</span>(<span class="kw">complete.cases</span>(bmi_cat, age_child)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-3" title="3"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">bmi_cat =</span> <span class="kw">reorder</span>(bmi_cat, age_child, median)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb316-4" title="4"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> age_child, <span class="dt">y =</span> bmi_cat, <span class="dt">fill =</span> bmi_cat, <span class="dt">height =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-5" title="5"><span class="st">    </span>ggridges<span class="op">::</span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="fl">0.85</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb316-6" title="6"><span class="st">    </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-7" title="7"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-8" title="8"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Ridgeline Plot of Age at Exam by BMI category (nnyfs)&quot;</span>,</a>
<a class="sourceLine" id="cb316-9" title="9">         <span class="dt">x =</span> <span class="st">&quot;Age of Child at Exam&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;BMI Category&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-10" title="10"><span class="st">    </span>ggridges<span class="op">::</span><span class="kw">theme_ridges</span>()</a></code></pre></div>
<pre><code>Picking joint bandwidth of 1.15</code></pre>
<p><img src="2019-431-book_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R4DS">
<p>Grolemund, Garrett, and Hadley Wickham. 2019. <em>R for Data Science</em>. O’Reilly. <a href="http://r4ds.had.co.nz/">http://r4ds.had.co.nz/</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>These were originally called joy plots, and the tools were contained in the <code>ggjoy</code> package but that name and package has been deprecated in favor of <code>ggridges</code>.<a href="summarizing-data-within-subgroups.html#fnref8" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-transformations-to-normalize-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="straight-line-models-and-correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/10_subgroup_summaries.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["2019-431-book.pdf", "2019-431-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
