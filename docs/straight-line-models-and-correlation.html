<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Straight Line Models and Correlation | Data Science for Biological, Medical and Health Research: Notes for PQHS 431</title>
  <meta name="description" content="Chapter 11 Straight Line Models and Correlation | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Straight Line Models and Correlation | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Straight Line Models and Correlation | Data Science for Biological, Medical and Health Research: Notes for PQHS 431" />
  
  
  

<meta name="author" content="Thomas E. Love, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="summarizing-data-within-subgroups.html">
<link rel="next" href="studying-crab-claws-crabs.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notes for PQHS 431</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#structure"><i class="fa fa-check"></i>Structure</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#course-philosophy"><i class="fa fa-check"></i>Course Philosophy</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#working-with-this-document"><i class="fa fa-check"></i>Working with this Document</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="data-science.html"><a href="data-science.html"><i class="fa fa-check"></i><b>1</b> Data Science</a><ul>
<li class="chapter" data-level="1.1" data-path="data-science.html"><a href="data-science.html#why-a-unicorn"><i class="fa fa-check"></i><b>1.1</b> Why a unicorn?</a></li>
<li class="chapter" data-level="1.2" data-path="data-science.html"><a href="data-science.html#data-science-project-cycle"><i class="fa fa-check"></i><b>1.2</b> Data Science Project Cycle</a></li>
<li class="chapter" data-level="1.3" data-path="data-science.html"><a href="data-science.html#what-will-we-discuss-in-431"><i class="fa fa-check"></i><b>1.3</b> What Will We Discuss in 431?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rsetup.html"><a href="Rsetup.html"><i class="fa fa-check"></i><b>2</b> Setting Up R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rsetup.html"><a href="Rsetup.html#r-markdown"><i class="fa fa-check"></i><b>2.1</b> R Markdown</a></li>
<li class="chapter" data-level="2.2" data-path="Rsetup.html"><a href="Rsetup.html#r-packages"><i class="fa fa-check"></i><b>2.2</b> R Packages</a></li>
<li class="chapter" data-level="2.3" data-path="Rsetup.html"><a href="Rsetup.html#other-packages"><i class="fa fa-check"></i><b>2.3</b> Other Packages</a></li>
</ul></li>
<li class="part"><span><b>Part A. Exploring Data</b></span></li>
<li class="chapter" data-level="3" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>3</b> Visualizing Data</a><ul>
<li class="chapter" data-level="3.1" data-path="dataviz.html"><a href="dataviz.html#the-nhanes-data-collecting-a-sample"><i class="fa fa-check"></i><b>3.1</b> The NHANES data: Collecting a Sample</a></li>
<li class="chapter" data-level="3.2" data-path="dataviz.html"><a href="dataviz.html#age-and-height"><i class="fa fa-check"></i><b>3.2</b> Age and Height</a></li>
<li class="chapter" data-level="3.3" data-path="dataviz.html"><a href="dataviz.html#subset-of-subjects-with-known-age-and-height"><i class="fa fa-check"></i><b>3.3</b> Subset of Subjects with Known Age and Height</a><ul>
<li class="chapter" data-level="3.3.1" data-path="dataviz.html"><a href="dataviz.html#the-distinction-between-gender-and-sex"><i class="fa fa-check"></i><b>3.3.1</b> The Distinction between <code>Gender</code> and <code>Sex</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dataviz.html"><a href="dataviz.html#age-height-and-sex"><i class="fa fa-check"></i><b>3.4</b> Age-Height and Sex?</a><ul>
<li class="chapter" data-level="3.4.1" data-path="dataviz.html"><a href="dataviz.html#can-we-show-the-female-and-male-relationships-in-separate-panels"><i class="fa fa-check"></i><b>3.4.1</b> Can we show the Female and Male relationships in separate panels?</a></li>
<li class="chapter" data-level="3.4.2" data-path="dataviz.html"><a href="dataviz.html#can-we-add-a-smooth-curve-to-show-the-relationship-in-each-plot"><i class="fa fa-check"></i><b>3.4.2</b> Can we add a smooth curve to show the relationship in each plot?</a></li>
<li class="chapter" data-level="3.4.3" data-path="dataviz.html"><a href="dataviz.html#what-if-we-want-to-assume-straight-line-relationships"><i class="fa fa-check"></i><b>3.4.3</b> What if we want to assume straight line relationships?</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="dataviz.html"><a href="dataviz.html#a-new-subset-ages-21-79"><i class="fa fa-check"></i><b>3.5</b> A New Subset: Ages 21-79</a></li>
<li class="chapter" data-level="3.6" data-path="dataviz.html"><a href="dataviz.html#distribution-of-heights"><i class="fa fa-check"></i><b>3.6</b> Distribution of Heights</a><ul>
<li class="chapter" data-level="3.6.1" data-path="dataviz.html"><a href="dataviz.html#changing-a-histograms-fill-and-color"><i class="fa fa-check"></i><b>3.6.1</b> Changing a Histogram’s Fill and Color</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="dataviz.html"><a href="dataviz.html#height-and-sex"><i class="fa fa-check"></i><b>3.7</b> Height and Sex</a><ul>
<li class="chapter" data-level="3.7.1" data-path="dataviz.html"><a href="dataviz.html#a-boxplot-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.1</b> A Boxplot of Height by Sex</a></li>
<li class="chapter" data-level="3.7.2" data-path="dataviz.html"><a href="dataviz.html#histograms-of-height-by-sex"><i class="fa fa-check"></i><b>3.7.2</b> Histograms of Height by Sex</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="dataviz.html"><a href="dataviz.html#a-look-at-body-mass-index"><i class="fa fa-check"></i><b>3.8</b> A Look at Body-Mass Index</a><ul>
<li class="chapter" data-level="3.8.1" data-path="dataviz.html"><a href="dataviz.html#bmi-by-sex"><i class="fa fa-check"></i><b>3.8.1</b> BMI by Sex</a></li>
<li class="chapter" data-level="3.8.2" data-path="dataviz.html"><a href="dataviz.html#bmi-and-diabetes"><i class="fa fa-check"></i><b>3.8.2</b> BMI and Diabetes</a></li>
<li class="chapter" data-level="3.8.3" data-path="dataviz.html"><a href="dataviz.html#bmi-and-race1"><i class="fa fa-check"></i><b>3.8.3</b> BMI and Race1</a></li>
<li class="chapter" data-level="3.8.4" data-path="dataviz.html"><a href="dataviz.html#bmi-and-pulse-rate"><i class="fa fa-check"></i><b>3.8.4</b> BMI and Pulse Rate</a></li>
<li class="chapter" data-level="3.8.5" data-path="dataviz.html"><a href="dataviz.html#diabetes-vs.-no-diabetes"><i class="fa fa-check"></i><b>3.8.5</b> Diabetes vs. No Diabetes</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="dataviz.html"><a href="dataviz.html#general-health-status"><i class="fa fa-check"></i><b>3.9</b> General Health Status</a><ul>
<li class="chapter" data-level="3.9.1" data-path="dataviz.html"><a href="dataviz.html#bar-chart-for-categorical-data"><i class="fa fa-check"></i><b>3.9.1</b> Bar Chart for Categorical Data</a></li>
<li class="chapter" data-level="3.9.2" data-path="dataviz.html"><a href="dataviz.html#working-with-tables"><i class="fa fa-check"></i><b>3.9.2</b> Working with Tables</a></li>
<li class="chapter" data-level="3.9.3" data-path="dataviz.html"><a href="dataviz.html#bmi-by-general-health-status"><i class="fa fa-check"></i><b>3.9.3</b> BMI by General Health Status</a></li>
<li class="chapter" data-level="3.9.4" data-path="dataviz.html"><a href="dataviz.html#bmi-by-diabetes-and-general-health-status"><i class="fa fa-check"></i><b>3.9.4</b> BMI by Diabetes and General Health Status</a></li>
<li class="chapter" data-level="3.9.5" data-path="dataviz.html"><a href="dataviz.html#bmi-by-sex-and-general-health-status"><i class="fa fa-check"></i><b>3.9.5</b> BMI by Sex and General Health Status</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="dataviz.html"><a href="dataviz.html#conclusions"><i class="fa fa-check"></i><b>3.10</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html"><i class="fa fa-check"></i><b>4</b> Data Structures and Types of Variables</a><ul>
<li class="chapter" data-level="4.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#data-require-structure-and-context"><i class="fa fa-check"></i><b>4.1</b> Data require structure and context</a></li>
<li class="chapter" data-level="4.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#createnh_adults"><i class="fa fa-check"></i><b>4.2</b> A New NHANES Adult Sample</a><ul>
<li class="chapter" data-level="4.2.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#summarizing-the-datas-structure"><i class="fa fa-check"></i><b>4.2.1</b> Summarizing the Data’s Structure</a></li>
<li class="chapter" data-level="4.2.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#what-are-the-variables"><i class="fa fa-check"></i><b>4.2.2</b> What are the variables?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#types-of-variables"><i class="fa fa-check"></i><b>4.3</b> Types of Variables</a><ul>
<li class="chapter" data-level="4.3.1" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#quantitative-variables"><i class="fa fa-check"></i><b>4.3.1</b> Quantitative Variables</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-structures-and-types-of-variables.html"><a href="data-structures-and-types-of-variables.html#qualitative-categorical-variables"><i class="fa fa-check"></i><b>4.3.2</b> Qualitative (Categorical) Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html"><i class="fa fa-check"></i><b>5</b> Summarizing Quantitative Variables</a><ul>
<li class="chapter" data-level="5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-summary-function-for-quantitative-data"><i class="fa fa-check"></i><b>5.1</b> The <code>summary</code> function for Quantitative data</a></li>
<li class="chapter" data-level="5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-center-of-a-distribution"><i class="fa fa-check"></i><b>5.2</b> Measuring the Center of a Distribution</a><ul>
<li class="chapter" data-level="5.2.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mean-and-the-median"><i class="fa fa-check"></i><b>5.2.1</b> The Mean and The Median</a></li>
<li class="chapter" data-level="5.2.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#dealing-with-missingness"><i class="fa fa-check"></i><b>5.2.2</b> Dealing with Missingness</a></li>
<li class="chapter" data-level="5.2.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-mode-of-a-quantitative-variable"><i class="fa fa-check"></i><b>5.2.3</b> The Mode of a Quantitative Variable</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-spread-of-a-distribution"><i class="fa fa-check"></i><b>5.3</b> Measuring the Spread of a Distribution</a><ul>
<li class="chapter" data-level="5.3.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#rangeandiqr"><i class="fa fa-check"></i><b>5.3.1</b> The Range and the Interquartile Range (IQR)</a></li>
<li class="chapter" data-level="5.3.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#the-variance-and-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.2</b> The Variance and the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#obtaining-the-variance-and-standard-deviation-in-r"><i class="fa fa-check"></i><b>5.3.3</b> Obtaining the Variance and Standard Deviation in R</a></li>
<li class="chapter" data-level="5.3.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#defining-the-variance-and-standard-deviation"><i class="fa fa-check"></i><b>5.3.4</b> Defining the Variance and Standard Deviation</a></li>
<li class="chapter" data-level="5.3.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#empirical-rule-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.5</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="5.3.6" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#chebyshevs-inequality-one-interpretation-of-the-standard-deviation"><i class="fa fa-check"></i><b>5.3.6</b> Chebyshev’s Inequality: One Interpretation of the Standard Deviation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#measuring-the-shape-of-a-distribution"><i class="fa fa-check"></i><b>5.4</b> Measuring the Shape of a Distribution</a><ul>
<li class="chapter" data-level="5.4.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#multimodal-vs.-unimodal-distributions"><i class="fa fa-check"></i><b>5.4.1</b> Multimodal vs. Unimodal distributions</a></li>
<li class="chapter" data-level="5.4.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#skew"><i class="fa fa-check"></i><b>5.4.2</b> Skew</a></li>
<li class="chapter" data-level="5.4.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#kurtosis"><i class="fa fa-check"></i><b>5.4.3</b> Kurtosis</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#more-detailed-numerical-summaries-for-quantitative-variables"><i class="fa fa-check"></i><b>5.5</b> More Detailed Numerical Summaries for Quantitative Variables</a><ul>
<li class="chapter" data-level="5.5.1" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#favstats-in-the-mosaic-package"><i class="fa fa-check"></i><b>5.5.1</b> <code>favstats</code> in the <code>mosaic</code> package</a></li>
<li class="chapter" data-level="5.5.2" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-psych-package"><i class="fa fa-check"></i><b>5.5.2</b> <code>describe</code> in the <code>psych</code> package</a></li>
<li class="chapter" data-level="5.5.3" data-path="summarizing-quantities.html"><a href="summarizing-quantities.html#describe-in-the-hmisc-package"><i class="fa fa-check"></i><b>5.5.3</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html"><i class="fa fa-check"></i><b>6</b> Summarizing Categorical Variables</a><ul>
<li class="chapter" data-level="6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-summary-function-for-categorical-data"><i class="fa fa-check"></i><b>6.1</b> The <code>summary</code> function for Categorical data</a></li>
<li class="chapter" data-level="6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#tables-to-describe-one-categorical-variable"><i class="fa fa-check"></i><b>6.2</b> Tables to describe One Categorical Variable</a></li>
<li class="chapter" data-level="6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#the-mode-of-a-categorical-variable"><i class="fa fa-check"></i><b>6.3</b> The Mode of a Categorical Variable</a></li>
<li class="chapter" data-level="6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#describe-in-the-hmisc-package-1"><i class="fa fa-check"></i><b>6.4</b> <code>describe</code> in the <code>Hmisc</code> package</a></li>
<li class="chapter" data-level="6.5" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-tabulations"><i class="fa fa-check"></i><b>6.5</b> Cross-Tabulations</a><ul>
<li class="chapter" data-level="6.5.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#cross-classifying-three-categorical-variables"><i class="fa fa-check"></i><b>6.5.1</b> Cross-Classifying Three Categorical Variables</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#constructing-tables-well"><i class="fa fa-check"></i><b>6.6</b> Constructing Tables Well</a><ul>
<li class="chapter" data-level="6.6.1" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#alabama-first"><i class="fa fa-check"></i><b>6.6.1</b> Alabama First!</a></li>
<li class="chapter" data-level="6.6.2" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#order-rows-and-columns-sensibly"><i class="fa fa-check"></i><b>6.6.2</b> Order rows and columns sensibly</a></li>
<li class="chapter" data-level="6.6.3" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#round---a-lot"><i class="fa fa-check"></i><b>6.6.3</b> Round - a lot!</a></li>
<li class="chapter" data-level="6.6.4" data-path="summarizing-categorical-variables.html"><a href="summarizing-categorical-variables.html#all-is-different-and-important"><i class="fa fa-check"></i><b>6.6.4</b> ALL is different and important</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="NYFS-Study.html"><a href="NYFS-Study.html"><i class="fa fa-check"></i><b>7</b> The National Youth Fitness Survey (<code>nyfs1</code>)</a><ul>
<li class="chapter" data-level="7.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#looking-over-the-data-set"><i class="fa fa-check"></i><b>7.1</b> Looking over the Data Set</a><ul>
<li class="chapter" data-level="7.1.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#subject.id"><i class="fa fa-check"></i><b>7.1.1</b> subject.id</a></li>
<li class="chapter" data-level="7.1.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#sex"><i class="fa fa-check"></i><b>7.1.2</b> sex</a></li>
<li class="chapter" data-level="7.1.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#age.exam"><i class="fa fa-check"></i><b>7.1.3</b> age.exam</a></li>
<li class="chapter" data-level="7.1.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi"><i class="fa fa-check"></i><b>7.1.4</b> bmi</a></li>
<li class="chapter" data-level="7.1.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#bmi.cat"><i class="fa fa-check"></i><b>7.1.5</b> bmi.cat</a></li>
<li class="chapter" data-level="7.1.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#waist.circ"><i class="fa fa-check"></i><b>7.1.6</b> waist.circ</a></li>
<li class="chapter" data-level="7.1.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#triceps.skinfold"><i class="fa fa-check"></i><b>7.1.7</b> triceps.skinfold</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#summarizing-the-data-set"><i class="fa fa-check"></i><b>7.2</b> Summarizing the Data Set</a><ul>
<li class="chapter" data-level="7.2.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-five-number-summary-quantiles-and-iqr"><i class="fa fa-check"></i><b>7.2.1</b> The Five Number Summary, Quantiles and IQR</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="NYFS-Study.html"><a href="NYFS-Study.html#additional-summaries-from-favstats"><i class="fa fa-check"></i><b>7.3</b> Additional Summaries from <code>favstats</code></a></li>
<li class="chapter" data-level="7.4" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-histogram"><i class="fa fa-check"></i><b>7.4</b> The Histogram</a><ul>
<li class="chapter" data-level="7.4.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#freedman-diaconis-rule-to-select-bin-width"><i class="fa fa-check"></i><b>7.4.1</b> Freedman-Diaconis Rule to select bin width</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-note-on-colors"><i class="fa fa-check"></i><b>7.5</b> A Note on Colors</a></li>
<li class="chapter" data-level="7.6" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-stem-and-leaf"><i class="fa fa-check"></i><b>7.6</b> The Stem-and-Leaf</a><ul>
<li class="chapter" data-level="7.6.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-fancier-stem-and-leaf-display"><i class="fa fa-check"></i><b>7.6.1</b> A Fancier Stem-and-Leaf Display</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-dot-plot-to-display-a-distribution"><i class="fa fa-check"></i><b>7.7</b> The Dot Plot to display a distribution</a></li>
<li class="chapter" data-level="7.8" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-frequency-polygon"><i class="fa fa-check"></i><b>7.8</b> The Frequency Polygon</a></li>
<li class="chapter" data-level="7.9" data-path="NYFS-Study.html"><a href="NYFS-Study.html#plotting-the-probability-density-function"><i class="fa fa-check"></i><b>7.9</b> Plotting the Probability Density Function</a></li>
<li class="chapter" data-level="7.10" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-boxplot"><i class="fa fa-check"></i><b>7.10</b> The Boxplot</a><ul>
<li class="chapter" data-level="7.10.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#drawing-a-boxplot-for-one-variable-in-ggplot2"><i class="fa fa-check"></i><b>7.10.1</b> Drawing a Boxplot for One Variable in <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="NYFS-Study.html"><a href="NYFS-Study.html#a-simple-comparison-boxplot"><i class="fa fa-check"></i><b>7.11</b> A Simple Comparison Boxplot</a></li>
<li class="chapter" data-level="7.12" data-path="NYFS-Study.html"><a href="NYFS-Study.html#using-describe-in-the-psych-library"><i class="fa fa-check"></i><b>7.12</b> Using <code>describe</code> in the <code>psych</code> library</a><ul>
<li class="chapter" data-level="7.12.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-trimmed-mean"><i class="fa fa-check"></i><b>7.12.1</b> The Trimmed Mean</a></li>
<li class="chapter" data-level="7.12.2" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-median-absolute-deviation"><i class="fa fa-check"></i><b>7.12.2</b> The Median Absolute Deviation</a></li>
</ul></li>
<li class="chapter" data-level="7.13" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-skew"><i class="fa fa-check"></i><b>7.13</b> Assessing Skew</a><ul>
<li class="chapter" data-level="7.13.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#non-parametric-skew-via-skew1"><i class="fa fa-check"></i><b>7.13.1</b> Non-parametric Skew via skew<sub>1</sub></a></li>
</ul></li>
<li class="chapter" data-level="7.14" data-path="NYFS-Study.html"><a href="NYFS-Study.html#assessing-kurtosis-heavy-tailedness"><i class="fa fa-check"></i><b>7.14</b> Assessing Kurtosis (Heavy-Tailedness)</a><ul>
<li class="chapter" data-level="7.14.1" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-standard-error-of-the-sample-mean"><i class="fa fa-check"></i><b>7.14.1</b> The Standard Error of the Sample Mean</a></li>
</ul></li>
<li class="chapter" data-level="7.15" data-path="NYFS-Study.html"><a href="NYFS-Study.html#the-describe-function-in-the-hmisc-library"><i class="fa fa-check"></i><b>7.15</b> The <code>describe</code> function in the <code>Hmisc</code> library</a></li>
<li class="chapter" data-level="7.16" data-path="NYFS-Study.html"><a href="NYFS-Study.html#xda-from-github-for-numerical-summaries-for-exploratory-data-analysis"><i class="fa fa-check"></i><b>7.16</b> <code>xda</code> from GitHub for numerical summaries for exploratory data analysis</a></li>
<li class="chapter" data-level="7.17" data-path="NYFS-Study.html"><a href="NYFS-Study.html#what-summaries-to-report"><i class="fa fa-check"></i><b>7.17</b> What Summaries to Report</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="assessing-normality.html"><a href="assessing-normality.html"><i class="fa fa-check"></i><b>8</b> Assessing Normality</a><ul>
<li class="chapter" data-level="8.1" data-path="assessing-normality.html"><a href="assessing-normality.html#empirical-rule-interpretation-of-the-standard-deviation-1"><i class="fa fa-check"></i><b>8.1</b> Empirical Rule Interpretation of the Standard Deviation</a></li>
<li class="chapter" data-level="8.2" data-path="assessing-normality.html"><a href="assessing-normality.html#describing-outlying-values-with-z-scores"><i class="fa fa-check"></i><b>8.2</b> Describing Outlying Values with Z Scores</a><ul>
<li class="chapter" data-level="8.2.1" data-path="assessing-normality.html"><a href="assessing-normality.html#fences-and-z-scores"><i class="fa fa-check"></i><b>8.2.1</b> Fences and Z Scores</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="assessing-normality.html"><a href="assessing-normality.html#comparing-a-histogram-to-a-normal-distribution"><i class="fa fa-check"></i><b>8.3</b> Comparing a Histogram to a Normal Distribution</a><ul>
<li class="chapter" data-level="8.3.1" data-path="assessing-normality.html"><a href="assessing-normality.html#histogram-of-bmi-with-normal-model-with-counts"><i class="fa fa-check"></i><b>8.3.1</b> Histogram of BMI with Normal model (with Counts)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="assessing-normality.html"><a href="assessing-normality.html#does-a-normal-model-work-well-for-the-ages"><i class="fa fa-check"></i><b>8.4</b> Does a Normal model work well for the Ages?</a></li>
<li class="chapter" data-level="8.5" data-path="assessing-normality.html"><a href="assessing-normality.html#the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.5</b> The Normal Q-Q Plot</a></li>
<li class="chapter" data-level="8.6" data-path="assessing-normality.html"><a href="assessing-normality.html#interpreting-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6</b> Interpreting the Normal Q-Q Plot</a><ul>
<li class="chapter" data-level="8.6.1" data-path="assessing-normality.html"><a href="assessing-normality.html#data-from-a-normal-distribution-shows-up-as-a-straight-line-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.1</b> Data from a Normal distribution shows up as a straight line in a Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.2" data-path="assessing-normality.html"><a href="assessing-normality.html#skew-is-indicated-by-monotonic-curves-in-the-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.2</b> Skew is indicated by monotonic curves in the Normal Q-Q plot</a></li>
<li class="chapter" data-level="8.6.3" data-path="assessing-normality.html"><a href="assessing-normality.html#direction-of-skew"><i class="fa fa-check"></i><b>8.6.3</b> Direction of Skew</a></li>
<li class="chapter" data-level="8.6.4" data-path="assessing-normality.html"><a href="assessing-normality.html#outlier-proneness-is-indicated-by-s-shaped-curves-in-a-normal-q-q-plot"><i class="fa fa-check"></i><b>8.6.4</b> Outlier-proneness is indicated by “s-shaped” curves in a Normal Q-Q plot</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="assessing-normality.html"><a href="assessing-normality.html#does-a-normal-distribution-fit-the-nyfs1-data-well"><i class="fa fa-check"></i><b>8.7</b> Does a Normal Distribution Fit the <code>nyfs1</code> Data Well?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html"><i class="fa fa-check"></i><b>9</b> Using Transformations to “Normalize” Distributions</a><ul>
<li class="chapter" data-level="9.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-ladder-of-power-transformations"><i class="fa fa-check"></i><b>9.1</b> The Ladder of Power Transformations</a></li>
<li class="chapter" data-level="9.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#using-the-ladder"><i class="fa fa-check"></i><b>9.2</b> Using the Ladder</a></li>
<li class="chapter" data-level="9.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#can-we-transform-waist-circumferences"><i class="fa fa-check"></i><b>9.3</b> Can we transform Waist Circumferences?</a><ul>
<li class="chapter" data-level="9.3.1" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-square"><i class="fa fa-check"></i><b>9.3.1</b> The Square</a></li>
<li class="chapter" data-level="9.3.2" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-square-root"><i class="fa fa-check"></i><b>9.3.2</b> The Square Root</a></li>
<li class="chapter" data-level="9.3.3" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#the-logarithm"><i class="fa fa-check"></i><b>9.3.3</b> The Logarithm</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#a-simulated-data-set-with-left-skew"><i class="fa fa-check"></i><b>9.4</b> A Simulated Data Set with Left Skew</a></li>
<li class="chapter" data-level="9.5" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#transformation-example-2-ladder-of-potential-transformations-in-frequency-polygons"><i class="fa fa-check"></i><b>9.5</b> Transformation Example 2: Ladder of Potential Transformations in Frequency Polygons</a></li>
<li class="chapter" data-level="9.6" data-path="using-transformations-to-normalize-distributions.html"><a href="using-transformations-to-normalize-distributions.html#transformation-example-2-ladder-with-normal-q-q-plots"><i class="fa fa-check"></i><b>9.6</b> Transformation Example 2 Ladder with Normal Q-Q Plots</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html"><i class="fa fa-check"></i><b>10</b> Summarizing data within subgroups</a><ul>
<li class="chapter" data-level="10.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-dplyr-and-summarise-to-build-a-tibble-of-summary-information"><i class="fa fa-check"></i><b>10.1</b> Using dplyr and summarise to build a tibble of summary information</a></li>
<li class="chapter" data-level="10.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-the-by-function-to-summarize-groups-numerically"><i class="fa fa-check"></i><b>10.2</b> Using the by function to summarize groups numerically</a></li>
<li class="chapter" data-level="10.3" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#boxplots-to-relate-an-outcome-to-a-categorical-predictor"><i class="fa fa-check"></i><b>10.3</b> Boxplots to Relate an Outcome to a Categorical Predictor</a><ul>
<li class="chapter" data-level="10.3.1" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#augmenting-the-boxplot-with-the-sample-mean"><i class="fa fa-check"></i><b>10.3.1</b> Augmenting the Boxplot with the Sample Mean</a></li>
<li class="chapter" data-level="10.3.2" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#adding-notches-to-a-boxplot"><i class="fa fa-check"></i><b>10.3.2</b> Adding Notches to a Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-histograms-to-make-comparisons"><i class="fa fa-check"></i><b>10.4</b> Using Multiple Histograms to Make Comparisons</a></li>
<li class="chapter" data-level="10.5" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#using-multiple-density-plots-to-make-comparisons"><i class="fa fa-check"></i><b>10.5</b> Using Multiple Density Plots to Make Comparisons</a></li>
<li class="chapter" data-level="10.6" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#building-a-violin-plot"><i class="fa fa-check"></i><b>10.6</b> Building a Violin Plot</a></li>
<li class="chapter" data-level="10.7" data-path="summarizing-data-within-subgroups.html"><a href="summarizing-data-within-subgroups.html#a-ridgeline-plot"><i class="fa fa-check"></i><b>10.7</b> A Ridgeline Plot</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html"><i class="fa fa-check"></i><b>11</b> Straight Line Models and Correlation</a><ul>
<li class="chapter" data-level="11.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#assessing-a-scatterplot"><i class="fa fa-check"></i><b>11.1</b> Assessing A Scatterplot</a><ul>
<li class="chapter" data-level="11.1.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#highlighting-an-unusual-point"><i class="fa fa-check"></i><b>11.1.1</b> Highlighting an unusual point</a></li>
<li class="chapter" data-level="11.1.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#adding-a-scatterplot-smooth-using-loess"><i class="fa fa-check"></i><b>11.1.2</b> Adding a Scatterplot Smooth using loess</a></li>
<li class="chapter" data-level="11.1.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#adding-a-straight-line-to-the-scatterplot"><i class="fa fa-check"></i><b>11.1.3</b> Adding a Straight Line to the Scatterplot</a></li>
<li class="chapter" data-level="11.1.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#what-line-does-r-fit"><i class="fa fa-check"></i><b>11.1.4</b> What Line Does R Fit?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlation-coefficients"><i class="fa fa-check"></i><b>11.2</b> Correlation Coefficients</a></li>
<li class="chapter" data-level="11.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-pearson-correlation-coefficient"><i class="fa fa-check"></i><b>11.3</b> The Pearson Correlation Coefficient</a></li>
<li class="chapter" data-level="11.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#a-simulated-example"><i class="fa fa-check"></i><b>11.4</b> A simulated example</a><ul>
<li class="chapter" data-level="11.4.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-alex"><i class="fa fa-check"></i><b>11.4.1</b> Data Set Alex</a></li>
<li class="chapter" data-level="11.4.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-bonnie"><i class="fa fa-check"></i><b>11.4.2</b> Data Set Bonnie</a></li>
<li class="chapter" data-level="11.4.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#correlations-for-all-six-data-sets-in-the-correx1-example"><i class="fa fa-check"></i><b>11.4.3</b> Correlations for All Six Data Sets in the Correx1 Example</a></li>
<li class="chapter" data-level="11.4.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#data-set-colin"><i class="fa fa-check"></i><b>11.4.4</b> Data Set Colin</a></li>
<li class="chapter" data-level="11.4.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#draw-the-picture"><i class="fa fa-check"></i><b>11.4.5</b> Draw the Picture!</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#estimating-correlation-from-scatterplots"><i class="fa fa-check"></i><b>11.5</b> Estimating Correlation from Scatterplots</a></li>
<li class="chapter" data-level="11.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#the-spearman-rank-correlation"><i class="fa fa-check"></i><b>11.6</b> The Spearman Rank Correlation</a><ul>
<li class="chapter" data-level="11.6.1" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-formula"><i class="fa fa-check"></i><b>11.6.1</b> Spearman Formula</a></li>
<li class="chapter" data-level="11.6.2" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#comparing-pearson-and-spearman-correlations"><i class="fa fa-check"></i><b>11.6.2</b> Comparing Pearson and Spearman Correlations</a></li>
<li class="chapter" data-level="11.6.3" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-1"><i class="fa fa-check"></i><b>11.6.3</b> Spearman vs. Pearson Example 1</a></li>
<li class="chapter" data-level="11.6.4" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-2"><i class="fa fa-check"></i><b>11.6.4</b> Spearman vs. Pearson Example 2</a></li>
<li class="chapter" data-level="11.6.5" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-3"><i class="fa fa-check"></i><b>11.6.5</b> Spearman vs. Pearson Example 3</a></li>
<li class="chapter" data-level="11.6.6" data-path="straight-line-models-and-correlation.html"><a href="straight-line-models-and-correlation.html#spearman-vs.-pearson-example-4"><i class="fa fa-check"></i><b>11.6.6</b> Spearman vs. Pearson Example 4</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html"><i class="fa fa-check"></i><b>12</b> Studying Crab Claws (<code>crabs</code>)</a><ul>
<li class="chapter" data-level="12.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#association-of-size-and-force"><i class="fa fa-check"></i><b>12.1</b> Association of Size and Force</a></li>
<li class="chapter" data-level="12.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#loess_smooth"><i class="fa fa-check"></i><b>12.2</b> The <code>loess</code> smooth</a><ul>
<li class="chapter" data-level="12.2.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#smoothing-within-species"><i class="fa fa-check"></i><b>12.2.1</b> Smoothing within Species</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#fitting-a-linear-regression-model"><i class="fa fa-check"></i><b>12.3</b> Fitting a Linear Regression Model</a></li>
<li class="chapter" data-level="12.4" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#is-a-linear-model-appropriate"><i class="fa fa-check"></i><b>12.4</b> Is a Linear Model Appropriate?</a><ul>
<li class="chapter" data-level="12.4.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#the-log-log-model"><i class="fa fa-check"></i><b>12.4.1</b> The log-log model</a></li>
<li class="chapter" data-level="12.4.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#how-does-this-compare-to-our-original-linear-model"><i class="fa fa-check"></i><b>12.4.2</b> How does this compare to our original linear model?</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#making-predictions-with-a-model"><i class="fa fa-check"></i><b>12.5</b> Making Predictions with a Model</a><ul>
<li class="chapter" data-level="12.5.1" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#predictions-after-a-transformation"><i class="fa fa-check"></i><b>12.5.1</b> Predictions After a Transformation</a></li>
<li class="chapter" data-level="12.5.2" data-path="studying-crab-claws-crabs.html"><a href="studying-crab-claws-crabs.html#comparing-model-predictions"><i class="fa fa-check"></i><b>12.5.2</b> Comparing Model Predictions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="WCGS-Study.html"><a href="WCGS-Study.html"><i class="fa fa-check"></i><b>13</b> The Western Collaborative Group Study</a><ul>
<li class="chapter" data-level="13.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#the-western-collaborative-group-study-wcgs-data-set"><i class="fa fa-check"></i><b>13.1</b> The Western Collaborative Group Study (<code>wcgs</code>) data set</a><ul>
<li class="chapter" data-level="13.1.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#structure-of-wcgs"><i class="fa fa-check"></i><b>13.1.1</b> Structure of <code>wcgs</code></a></li>
<li class="chapter" data-level="13.1.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#codebook-for-wcgs"><i class="fa fa-check"></i><b>13.1.2</b> Codebook for <code>wcgs</code></a></li>
<li class="chapter" data-level="13.1.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#quick-summary"><i class="fa fa-check"></i><b>13.1.3</b> Quick Summary</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#are-the-sbps-normally-distributed"><i class="fa fa-check"></i><b>13.2</b> Are the SBPs Normally Distributed?</a></li>
<li class="chapter" data-level="13.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#describing-outlying-values-with-z-scores-1"><i class="fa fa-check"></i><b>13.3</b> Describing Outlying Values with Z Scores</a></li>
<li class="chapter" data-level="13.4" data-path="WCGS-Study.html"><a href="WCGS-Study.html#does-weight-category-relate-to-sbp"><i class="fa fa-check"></i><b>13.4</b> Does Weight Category Relate to SBP?</a></li>
<li class="chapter" data-level="13.5" data-path="WCGS-Study.html"><a href="WCGS-Study.html#re-leveling-a-factor"><i class="fa fa-check"></i><b>13.5</b> Re-Leveling a Factor</a><ul>
<li class="chapter" data-level="13.5.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#sbp-by-weight-category"><i class="fa fa-check"></i><b>13.5.1</b> SBP by Weight Category</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="WCGS-Study.html"><a href="WCGS-Study.html#are-weight-and-sbp-linked"><i class="fa fa-check"></i><b>13.6</b> Are Weight and SBP Linked?</a></li>
<li class="chapter" data-level="13.7" data-path="WCGS-Study.html"><a href="WCGS-Study.html#sbp-and-weight-by-arcus-senilis-groups"><i class="fa fa-check"></i><b>13.7</b> SBP and Weight by Arcus Senilis groups?</a></li>
<li class="chapter" data-level="13.8" data-path="WCGS-Study.html"><a href="WCGS-Study.html#linear-model-for-sbp-weight-relationship-subjects-without-arcus-senilis"><i class="fa fa-check"></i><b>13.8</b> Linear Model for SBP-Weight Relationship: subjects without Arcus Senilis</a></li>
<li class="chapter" data-level="13.9" data-path="WCGS-Study.html"><a href="WCGS-Study.html#linear-model-for-sbp-weight-relationship-subjects-with-arcus-senilis"><i class="fa fa-check"></i><b>13.9</b> Linear Model for SBP-Weight Relationship: subjects with Arcus Senilis</a></li>
<li class="chapter" data-level="13.10" data-path="WCGS-Study.html"><a href="WCGS-Study.html#including-arcus-status-in-the-model"><i class="fa fa-check"></i><b>13.10</b> Including Arcus Status in the model</a></li>
<li class="chapter" data-level="13.11" data-path="WCGS-Study.html"><a href="WCGS-Study.html#predictions-from-these-linear-models"><i class="fa fa-check"></i><b>13.11</b> Predictions from these Linear Models</a></li>
<li class="chapter" data-level="13.12" data-path="WCGS-Study.html"><a href="WCGS-Study.html#scatterplots-with-facets-across-a-categorical-variable"><i class="fa fa-check"></i><b>13.12</b> Scatterplots with Facets Across a Categorical Variable</a></li>
<li class="chapter" data-level="13.13" data-path="WCGS-Study.html"><a href="WCGS-Study.html#scatterplot-and-correlation-matrices"><i class="fa fa-check"></i><b>13.13</b> Scatterplot and Correlation Matrices</a><ul>
<li class="chapter" data-level="13.13.1" data-path="WCGS-Study.html"><a href="WCGS-Study.html#using-the-car-package"><i class="fa fa-check"></i><b>13.13.1</b> Using the car package</a></li>
<li class="chapter" data-level="13.13.2" data-path="WCGS-Study.html"><a href="WCGS-Study.html#displaying-a-correlation-matrix"><i class="fa fa-check"></i><b>13.13.2</b> Displaying a Correlation Matrix</a></li>
<li class="chapter" data-level="13.13.3" data-path="WCGS-Study.html"><a href="WCGS-Study.html#augmented-scatterplot-matrix"><i class="fa fa-check"></i><b>13.13.3</b> Augmented Scatterplot Matrix</a></li>
<li class="chapter" data-level="13.13.4" data-path="WCGS-Study.html"><a href="WCGS-Study.html#using-the-ggally-package"><i class="fa fa-check"></i><b>13.13.4</b> Using the <code>GGally</code> package</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html"><i class="fa fa-check"></i><b>14</b> Part A: A Few of the Key Points</a><ul>
<li class="chapter" data-level="14.1" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#key-graphical-descriptive-summaries-for-quantitative-data"><i class="fa fa-check"></i><b>14.1</b> Key Graphical Descriptive Summaries for Quantitative Data</a></li>
<li class="chapter" data-level="14.2" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#key-numerical-descriptive-summaries-for-quantitative-data"><i class="fa fa-check"></i><b>14.2</b> Key Numerical Descriptive Summaries for Quantitative Data</a></li>
<li class="chapter" data-level="14.3" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#the-empirical-rule---interpreting-a-standard-deviation"><i class="fa fa-check"></i><b>14.3</b> The Empirical Rule - Interpreting a Standard Deviation</a></li>
<li class="chapter" data-level="14.4" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#identifying-outliers-using-fences-andor-z-scores"><i class="fa fa-check"></i><b>14.4</b> Identifying “Outliers” Using Fences and/or Z Scores</a></li>
<li class="chapter" data-level="14.5" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#summarizing-bivariate-associations-scatterplots-and-regression-lines"><i class="fa fa-check"></i><b>14.5</b> Summarizing Bivariate Associations: Scatterplots and Regression Lines</a></li>
<li class="chapter" data-level="14.6" data-path="part-a-a-few-of-the-key-points.html"><a href="part-a-a-few-of-the-key-points.html#summarizing-bivariate-associations-with-correlations"><i class="fa fa-check"></i><b>14.6</b> Summarizing Bivariate Associations With Correlations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="this-is-work-in-progress.html"><a href="this-is-work-in-progress.html"><i class="fa fa-check"></i>This is Work in Progress</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Biological, Medical and Health Research: Notes for PQHS 431</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="straight-line-models-and-correlation" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Straight Line Models and Correlation</h1>
<div id="assessing-a-scatterplot" class="section level2">
<h2><span class="header-section-number">11.1</span> Assessing A Scatterplot</h2>
<p>Let’s consider the relationship of <code>bmi</code> and <code>waist.circ</code> in the <code>nyfs1</code> data. We’ll begin our investigation, as we always should, by drawing a relevant picture. For the association of two quantitative variables, a <strong>scatterplot</strong> is usually the right start. Each subject in the <code>nyfs1</code> data is represented by one of the points below.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> nyfs1, <span class="kw">aes</span>(<span class="dt">x =</span> waist.circ, <span class="dt">y =</span> bmi)) <span class="op">+</span></a>
<a class="sourceLine" id="cb286-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb286-3" title="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BMI vs. Waist Circumference in the nyfs1 data&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/nyfs1_scatter_bmi_by_waist1-fig-1.png" width="672" /></p>
<p>Here, I’ve arbitrarily decided to place <code>bmi</code> on the vertical axis, and <code>waist.circ</code> on the horizontal. Fitting a prediction model to this scatterplot will then require that we predict <code>bmi</code> on the basis of <code>waist.circ</code>.</p>
<p>In this case, the pattern appears to be:</p>
<ol style="list-style-type: decimal">
<li><strong>direct</strong>, or positive, in that the values of the <span class="math inline">\(x\)</span> variable (<code>waist.circ</code>) increase, so do the values of the <span class="math inline">\(y\)</span> variable (<code>bmi</code>). Essentially, it appears that subjects with larger waist circumferences also have larger BMIs, but we don’t know cause and effect here.</li>
<li>fairly <strong>linear</strong> in that most of the points cluster around what appears to be a pattern which is well-fitted by a straight line.</li>
<li><strong>strong</strong> in that the range of values for <code>bmi</code> associated with any particular value of <code>waist.circ</code> is fairly tight. If we know someone’s waist circumference, we can pretty accurately predict their BMI, among the subjects in these data.</li>
<li>that we see at least one fairly substantial <strong>outlier</strong> value at the upper left of the plot, which I’ll identify in the plot below with a red dot.</li>
</ol>
<div id="highlighting-an-unusual-point" class="section level3">
<h3><span class="header-section-number">11.1.1</span> Highlighting an unusual point</h3>
<p>To highlight the outlier, I’ll note that it’s the only point with BMI &gt; 35 and waist.circ &lt; 70. So I’ll create a subset of the <code>nyfs1</code> data containing the point that meets that standard, and then add a red point and a label to the plot.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb287-1" title="1"><span class="co"># identify outlier and place it in data frame s1 </span></a>
<a class="sourceLine" id="cb287-2" title="2">s1 &lt;-<span class="st"> </span><span class="kw">filter</span>(nyfs1, bmi<span class="op">&gt;</span><span class="dv">35</span> <span class="op">&amp;</span><span class="st"> </span>waist.circ <span class="op">&lt;</span><span class="st"> </span><span class="dv">70</span>)</a>
<a class="sourceLine" id="cb287-3" title="3"></a>
<a class="sourceLine" id="cb287-4" title="4"><span class="kw">ggplot</span>(<span class="dt">data =</span> nyfs1, <span class="kw">aes</span>(<span class="dt">x =</span> waist.circ, <span class="dt">y =</span> bmi)) <span class="op">+</span></a>
<a class="sourceLine" id="cb287-5" title="5"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb287-6" title="6"><span class="st">    </span><span class="co"># next two lines add outlier color, and then a label</span></a>
<a class="sourceLine" id="cb287-7" title="7"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> s1, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb287-8" title="8"><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">data =</span> s1, <span class="dt">label =</span> s1<span class="op">$</span>subject.id, <span class="dt">vjust =</span> <span class="dv">-1</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb287-9" title="9"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BMI vs. Waist Circumference in the nyfs1 data&quot;</span>,</a>
<a class="sourceLine" id="cb287-10" title="10">         <span class="dt">subtitle =</span> <span class="st">&quot;with outlier labeled by subject ID&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/nyfs1_scatter_bmi_by_waist2withoutliermarked-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1">s1</a></code></pre></div>
<pre><code># A tibble: 1 x 7
  subject.id sex   age.exam   bmi bmi.cat waist.circ triceps.skinfold
       &lt;int&gt; &lt;fct&gt;    &lt;int&gt; &lt;dbl&gt; &lt;fct&gt;        &lt;dbl&gt;            &lt;dbl&gt;
1      73202 Male        13    37 4 Obese       62.3              7.2</code></pre>
<p>Does it seem to you like a straight line model will describe this relationship well?</p>
</div>
<div id="adding-a-scatterplot-smooth-using-loess" class="section level3">
<h3><span class="header-section-number">11.1.2</span> Adding a Scatterplot Smooth using loess</h3>
<p>We’ll use the <strong>loess</strong> procedure to fit a smooth curve to the data, which attempts to capture the general pattern.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> nyfs1, <span class="kw">aes</span>(<span class="dt">x =</span> waist.circ, <span class="dt">y =</span> bmi)) <span class="op">+</span></a>
<a class="sourceLine" id="cb290-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb290-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb290-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BMI vs. Waist Circumference in the nyfs1 data&quot;</span>,</a>
<a class="sourceLine" id="cb290-5" title="5">         <span class="dt">caption =</span> <span class="st">&quot;with fitted loess smooth&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/nyfs1_scatter_bmi_by_waistwithloess1-fig-1.png" width="672" /></p>
<p>The smooth curve backs up our earlier thought that a straight line might fit the data well. More on the loess smooth in the next chapter.</p>
</div>
<div id="adding-a-straight-line-to-the-scatterplot" class="section level3">
<h3><span class="header-section-number">11.1.3</span> Adding a Straight Line to the Scatterplot</h3>
<p>Let’s go ahead and add a straight line to the plot, and we’ll change the shape of the points to emphasize the fitted line a bit more.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb291-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> nyfs1, <span class="kw">aes</span>(<span class="dt">x =</span> waist.circ, <span class="dt">y =</span> bmi)) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="st">&quot;o&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;deeppink&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;BMI vs. Waist Circumference in the nyfs1 data&quot;</span>,</a>
<a class="sourceLine" id="cb291-5" title="5">         <span class="dt">caption =</span> <span class="st">&quot;with fitted straight line model&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb291-6" title="6"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/nyfs1_scatter_bmi_by_waistwitlm1-fig-1.png" width="672" /></p>
<p>How can we, mathematically, characterize that line? As with any straight line, our model equation requires us to specify two parameters: a slope and an intercept (sometimes called the y-intercept.)</p>
</div>
<div id="what-line-does-r-fit" class="section level3">
<h3><span class="header-section-number">11.1.4</span> What Line Does R Fit?</h3>
<p>To identify the equation R used to fit this line (using the method of least squares), we use the <code>lm</code> command</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb292-1" title="1"><span class="kw">lm</span>(bmi <span class="op">~</span><span class="st"> </span>waist.circ, <span class="dt">data =</span> nyfs1)</a></code></pre></div>
<pre><code>
Call:
lm(formula = bmi ~ waist.circ, data = nyfs1)

Coefficients:
(Intercept)   waist.circ  
    -0.0665       0.2889  </code></pre>
<p>So the fitted line is specified as</p>
<p><span class="math display">\[
\mbox{BMI} = -0.066 + 0.289 \mbox{ Waist Circumference}
\]</span></p>
<p>A detailed summary of the fitted linear regression model is also available.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb294-1" title="1"><span class="kw">summary</span>(<span class="kw">lm</span>(bmi <span class="op">~</span><span class="st"> </span>waist.circ, <span class="dt">data =</span> nyfs1))</a></code></pre></div>
<pre><code>
Call:
lm(formula = bmi ~ waist.circ, data = nyfs1)

Residuals:
   Min     1Q Median     3Q    Max 
-4.234 -1.094 -0.074  0.925 19.066 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.0665     0.2329   -0.29     0.78    
waist.circ    0.2889     0.0035   82.55   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.69 on 1414 degrees of freedom
Multiple R-squared:  0.828, Adjusted R-squared:  0.828 
F-statistic: 6.81e+03 on 1 and 1414 DF,  p-value: &lt;2e-16</code></pre>
<p>We’ll spend a lot of time working with these regression summaries, especially in Part C of the course.</p>
<p>For now, it will suffice to understand the following:</p>
<ul>
<li>The outcome variable in this model is <strong>bmi</strong>, and the predictor variable is <strong>waist.circ</strong>.</li>
<li>The straight line model for these data fitted by least squares is <code>bmi</code> = -0.066 + 0.289 <code>waist.circ</code></li>
<li>The slope of <code>waist.circ</code> is positive, which indicates that as <code>waist.circ</code> increases, we expect that <code>bmi</code> will also increase. Specifically, we expect that for every additional cm of waist circumference, the BMI will be 0.289 kg/m<sup>2</sup> larger.</li>
<li>The multiple R-squared (squared correlation coefficient) is 0.828, which implies that 82.8% of the variation in <code>bmi</code> is explained using this linear model with <code>waist.circ</code> It also implies that the Pearson correlation between <code>bmi</code> and <code>waist.circ</code> is the square root of 0.828, or 0.91. More on the Pearson correlation soon.</li>
</ul>
<p>So, if we plan to use a simple (least squares) linear regression model to describe BMI as a function of waist circumference, does it look like a least squares model is likely to be an effective choice here?</p>
</div>
</div>
<div id="correlation-coefficients" class="section level2">
<h2><span class="header-section-number">11.2</span> Correlation Coefficients</h2>
<p>Two different correlation measures are worth our immediate attention.</p>
<ul>
<li>The one most often used is called the <em>Pearson</em> correlation coefficient, and is symbolized with the letter r or sometimes the Greek letter rho (<span class="math inline">\(\rho\)</span>).</li>
<li>Another tool is the Spearman rank correlation coefficient, also occasionally symbolized by <span class="math inline">\(\rho\)</span>).</li>
</ul>
<p>For the <code>nyfs1</code> data, the Pearson correlation of <code>bmi</code> and <code>waist.circ</code> can be found using the <code>cor()</code> function.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb296-1" title="1"><span class="kw">cor</span>(nyfs1<span class="op">$</span>bmi, nyfs1<span class="op">$</span>waist.circ)</a></code></pre></div>
<pre><code>[1] 0.91</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb298-1" title="1">nyfs1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-2" title="2"><span class="st">    </span><span class="kw">select</span>(bmi, waist.circ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb298-3" title="3"><span class="st">    </span><span class="kw">cor</span>()</a></code></pre></div>
<pre><code>            bmi waist.circ
bmi        1.00       0.91
waist.circ 0.91       1.00</code></pre>
<p>Note that the correlation of any variable with itself is 1, and that the correlation of <code>bmi</code> with <code>waist.circ</code> is the same regardless of whether you enter <code>bmi</code> first or <code>waist.circ</code> first.</p>
</div>
<div id="the-pearson-correlation-coefficient" class="section level2">
<h2><span class="header-section-number">11.3</span> The Pearson Correlation Coefficient</h2>
<p>Suppose we have <span class="math inline">\(n\)</span> observations on two variables, called X and Y. The Pearson correlation coefficient assesses how well the relationship between X and Y can be described using a linear function.</p>
<ul>
<li>The Pearson correlation is <strong>dimension-free</strong>.</li>
<li>It falls between -1 and +1, with the extremes corresponding to situations where all the points in a scatterplot fall exactly on a straight line with negative and positive slopes, respectively.</li>
<li>A Pearson correlation of zero corresponds to the situation where there is no linear association.</li>
<li>Unlike the estimated slope in a regression line, the sample correlation coefficient is symmetric in X and Y, so it does not depend on labeling one of them (Y) the response variable, and one of them (X) the predictor.</li>
</ul>
<p>Suppose we have <span class="math inline">\(n\)</span> observations on two variables, called <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, where <span class="math inline">\(\bar{X}\)</span> is the sample mean of <span class="math inline">\(X\)</span> and <span class="math inline">\(s_x\)</span> is the standard deviation of <span class="math inline">\(X\)</span>. The <strong>Pearson</strong> correlation coefficient <span class="math inline">\(r_{XY}\)</span> is:</p>
<p><span class="math display">\[
r_{XY} = \frac{1}{n-1} \sum\limits_{i=1}^n (\frac{x_i - \bar{x}}{s_x}) (\frac{y_i - \bar{y}}{s_y}) 
\]</span></p>
</div>
<div id="a-simulated-example" class="section level2">
<h2><span class="header-section-number">11.4</span> A simulated example</h2>
<p>The <code>correx1</code> data file contains six different sets of (x,y) points, identified by the <code>set</code> variable.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" title="1">correx1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/correx1.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>tbl_df </a>
<a class="sourceLine" id="cb300-2" title="2"></a>
<a class="sourceLine" id="cb300-3" title="3"><span class="kw">summary</span>(correx1)</a></code></pre></div>
<pre><code>       set           x              y       
 Alex    :62   Min.   : 5.9   Min.   : 7.3  
 Bonnie  :37   1st Qu.:29.5   1st Qu.:30.4  
 Colin   :36   Median :46.2   Median :46.9  
 Danielle:70   Mean   :46.5   Mean   :49.1  
 Earl    :15   3rd Qu.:63.3   3rd Qu.:68.1  
 Fiona   :57   Max.   :98.2   Max.   :95.4  </code></pre>
<div id="data-set-alex" class="section level3">
<h3><span class="header-section-number">11.4.1</span> Data Set Alex</h3>
<p>Let’s start by working with the <strong>Alex</strong> data set.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="kw">ggplot</span>(<span class="kw">filter</span>(correx1, set <span class="op">==</span><span class="st"> &quot;Alex&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb302-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb302-3" title="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;correx1: Data Set Alex&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1a-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb303-1" title="1"><span class="kw">ggplot</span>(<span class="kw">filter</span>(correx1, set <span class="op">==</span><span class="st"> &quot;Alex&quot;</span>), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb303-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb303-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb303-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;correx1: Alex, with loess smooth&quot;</span>)</a></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="2019-431-book_files/figure-html/correx1a2-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" title="1">setA &lt;-<span class="st"> </span><span class="kw">filter</span>(correx1, set <span class="op">==</span><span class="st"> &quot;Alex&quot;</span>)</a>
<a class="sourceLine" id="cb305-2" title="2"></a>
<a class="sourceLine" id="cb305-3" title="3"><span class="kw">ggplot</span>(setA, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb305-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb305-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb305-6" title="6"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;correx1: Alex, with Fitted Linear Model&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb305-7" title="7"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">75</span>, <span class="dt">y =</span> <span class="dv">75</span>, <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb305-8" title="8">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, <span class="kw">signif</span>(<span class="kw">cor</span>(setA<span class="op">$</span>x, setA<span class="op">$</span>y),<span class="dv">3</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb305-9" title="9"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">50</span>, <span class="dt">y =</span> <span class="dv">15</span>,  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb305-10" title="10">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;y = &quot;</span>, <span class="kw">signif</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(setA<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>setA<span class="op">$</span>x))[<span class="dv">1</span>],<span class="dv">3</span>), </a>
<a class="sourceLine" id="cb305-11" title="11">                           <span class="kw">signif</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(setA<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>setA<span class="op">$</span>x))[<span class="dv">2</span>],<span class="dv">2</span>), <span class="st">&quot;x&quot;</span>))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1a3-fig-1.png" width="672" /></p>
</div>
<div id="data-set-bonnie" class="section level3">
<h3><span class="header-section-number">11.4.2</span> Data Set Bonnie</h3>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">setB &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(correx1, set <span class="op">==</span><span class="st"> &quot;Bonnie&quot;</span>)</a>
<a class="sourceLine" id="cb306-2" title="2"></a>
<a class="sourceLine" id="cb306-3" title="3"><span class="kw">ggplot</span>(setB, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb306-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb306-5" title="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;correx1: Data Set Bonnie&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1b-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb307-1" title="1"><span class="kw">ggplot</span>(setB, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb307-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb307-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;correx1: Bonnie, with Fitted Linear Model&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-5" title="5"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">25</span>, <span class="dt">y =</span> <span class="dv">65</span>, <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">size =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb307-6" title="6">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, <span class="kw">signif</span>(<span class="kw">cor</span>(setB<span class="op">$</span>x, setB<span class="op">$</span>y),<span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb307-7" title="7"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">50</span>, <span class="dt">y =</span> <span class="dv">15</span>,  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb307-8" title="8">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;y = &quot;</span>, <span class="kw">signif</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(setB<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>setB<span class="op">$</span>x))[<span class="dv">1</span>],<span class="dv">3</span>), </a>
<a class="sourceLine" id="cb307-9" title="9">                           <span class="st">&quot; + &quot;</span>,</a>
<a class="sourceLine" id="cb307-10" title="10">                           <span class="kw">signif</span>(<span class="kw">coef</span>(<span class="kw">lm</span>(setB<span class="op">$</span>y <span class="op">~</span><span class="st"> </span>setB<span class="op">$</span>x))[<span class="dv">2</span>],<span class="dv">2</span>), <span class="st">&quot;x&quot;</span>))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1b2-fig-1.png" width="672" /></p>
</div>
<div id="correlations-for-all-six-data-sets-in-the-correx1-example" class="section level3">
<h3><span class="header-section-number">11.4.3</span> Correlations for All Six Data Sets in the Correx1 Example</h3>
<p>Let’s look at the Pearson correlations associated with each of the six data sets contained in the <code>correx1</code> example.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1">tab1 &lt;-<span class="st"> </span>correx1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb308-2" title="2"><span class="st">    </span><span class="kw">group_by</span>(set) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb308-3" title="3"><span class="st">    </span><span class="kw">summarise</span>(<span class="st">&quot;Pearson r&quot;</span> =<span class="st"> </span><span class="kw">round</span>(<span class="kw">cor</span>(x, y, <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>),<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb308-4" title="4"></a>
<a class="sourceLine" id="cb308-5" title="5">knitr<span class="op">::</span><span class="kw">kable</span>(tab1)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">set</th>
<th align="right">Pearson r</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alex</td>
<td align="right">-0.97</td>
</tr>
<tr class="even">
<td align="left">Bonnie</td>
<td align="right">0.80</td>
</tr>
<tr class="odd">
<td align="left">Colin</td>
<td align="right">-0.80</td>
</tr>
<tr class="even">
<td align="left">Danielle</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td align="left">Earl</td>
<td align="right">-0.01</td>
</tr>
<tr class="even">
<td align="left">Fiona</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
</div>
<div id="data-set-colin" class="section level3">
<h3><span class="header-section-number">11.4.4</span> Data Set Colin</h3>
<p>It looks like the picture for Colin should be very similar (in terms of scatter) to the picture for Bonnie, except that Colin will have a negative slope, rather than the positive one Bonnie has. Is that how this plays out?</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1">setBC &lt;-<span class="st"> </span><span class="kw">filter</span>(correx1, set <span class="op">==</span><span class="st"> &quot;Bonnie&quot;</span> <span class="op">|</span><span class="st"> </span>set <span class="op">==</span><span class="st"> &quot;Colin&quot;</span>)</a>
<a class="sourceLine" id="cb309-2" title="2"></a>
<a class="sourceLine" id="cb309-3" title="3"><span class="kw">ggplot</span>(setBC, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb309-4" title="4"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb309-5" title="5"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb309-6" title="6"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1bc-fig-1.png" width="672" /></p>
<p>Uh, oh. It looks like the point in Colin at the top right is twisting what would otherwise be a very straight regression model with an extremely strong negative correlation. There’s no better way to look for outliers than to examine the scatterplot.</p>
</div>
<div id="draw-the-picture" class="section level3">
<h3><span class="header-section-number">11.4.5</span> Draw the Picture!</h3>
<p>We’ve seen that Danielle, Earl and Fiona all show Pearson correlations of essentially zero. However, the three data sets look very different in a scatterplot.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="kw">ggplot</span>(correx1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb310-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb310-4" title="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx1-all1-fig-1.png" width="672" /></p>
<p>When we learn that the correlation is zero, we tend to assume we have a picture like the Danielle data set. If Danielle were our real data, we might well think that x would be of little use in predicting y.</p>
<ul>
<li>But what if our data looked like Earl? In the Earl data set, x is incredibly helpful in predicting y, but we can’t use a straight line model - instead, we need a non-linear modeling approach.</li>
<li>You’ll recall that the Fiona data set also had a Pearson correlation of zero. But here, the picture is rather more interesting.</li>
</ul>
<p>So, remember, draw the d%$# picture whenever you make use of a summary statistic, like a correlation coefficient, or linear model.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb311-1" title="1"><span class="kw">rm</span>(setA, setB, setBC, tab1)</a></code></pre></div>
</div>
</div>
<div id="estimating-correlation-from-scatterplots" class="section level2">
<h2><span class="header-section-number">11.5</span> Estimating Correlation from Scatterplots</h2>
<p>The correx2 data set is designed to help you calibrate yourself a bit in terms of estimating a correlation from a scatterplot. There are 11 data sets buried within the correx2 example, and they are labeled by their Pearson correlation coefficients, ranging from r = 0.01 to r = 0.999</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1">correx2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/correx2.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>tbl_df</a>
<a class="sourceLine" id="cb312-2" title="2"></a>
<a class="sourceLine" id="cb312-3" title="3">correx2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-4" title="4"><span class="st">    </span><span class="kw">group_by</span>(set) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb312-5" title="5"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">cor =</span> <span class="kw">round</span>(<span class="kw">cor</span>(x, y, <span class="dt">use=</span><span class="st">&quot;complete&quot;</span>),<span class="dv">3</span>))</a></code></pre></div>
<pre><code># A tibble: 11 x 2
   set       cor
   &lt;fct&gt;   &lt;dbl&gt;
 1 Set 01  0.01 
 2 Set 10  0.102
 3 Set 20  0.202
 4 Set 30  0.301
 5 Set 40  0.403
 6 Set 50  0.499
 7 Set 60  0.603
 8 Set 70  0.702
 9 Set 80  0.799
10 Set 90  0.902
11 Set 999 0.999</code></pre>
<p>Here is a plot of the 11 data sets, showing the increase in correlation from 0.01 (in Set 01) to 0.999 (in Set 999).</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1"><span class="kw">ggplot</span>(correx2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb314-3" title="3"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set) <span class="op">+</span></a>
<a class="sourceLine" id="cb314-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Pearson Correlations from 0.01 to 0.999&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx2a-fig-1.png" width="672" /></p>
<p>Note that R will allow you to fit a straight line model to any of these relationships, no matter how appropriate it might be to do so.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb315-1" title="1"><span class="kw">ggplot</span>(correx2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb315-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb315-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb315-4" title="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set) <span class="op">+</span></a>
<a class="sourceLine" id="cb315-5" title="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;R will fit a straight line to anything.&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx2b-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1"><span class="kw">ggplot</span>(correx2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb316-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-4" title="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set) <span class="op">+</span></a>
<a class="sourceLine" id="cb316-5" title="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Even if a loess smooth suggests non-linearity.&quot;</span>)</a></code></pre></div>
<pre><code>`geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="2019-431-book_files/figure-html/correx2c-fig-1.png" width="672" /></p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1"><span class="kw">ggplot</span>(correx2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">color =</span> <span class="kw">factor</span>(group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb318-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb318-3" title="3"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb318-4" title="4"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>set) <span class="op">+</span></a>
<a class="sourceLine" id="cb318-5" title="5"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Note: The same 10 points (in red) are in each plot.&quot;</span>)</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/correx2d-fig-1.png" width="672" /></p>
<p>Note that the same 10 points are used in each of the data sets. It’s always possible that a lurking subgroup of the data within a scatterplot follows a very strong linear relationship. This is why it’s so important (and difficult) not to go searching for such a thing without a strong foundation of logic, theory and prior empirical evidence.</p>
</div>
<div id="the-spearman-rank-correlation" class="section level2">
<h2><span class="header-section-number">11.6</span> The Spearman Rank Correlation</h2>
<p>The Spearman rank correlation coefficient is a rank-based measure of statistical dependence that assesses how well the relationship between X and Y can be described using a <strong>monotone function</strong> even if that relationship is not linear.</p>
<ul>
<li>A monotone function preserves order, that is, Y must either be strictly increasing as X increases, or strictly decreasing as X increases.</li>
<li>A Spearman correlation of 1.0 indicates simply that as X increases, Y always increases.</li>
<li>Like the Pearson correlation, the Spearman correlation is dimension-free, and falls between -1 and +1.</li>
<li>A positive Spearman correlation corresponds to an increasing (but not necessarily linear) association between X and Y, while a negative Spearman correlation corresponds to a decreasing (but again not necessarily linear) association.</li>
</ul>
<div id="spearman-formula" class="section level3">
<h3><span class="header-section-number">11.6.1</span> Spearman Formula</h3>
<p>To calculate the Spearman rank correlation, we take the ranks of the X and Y data, and then apply the usual Pearson correlation. To find the ranks, sort X and Y into ascending order, and then number them from 1 (smallest) to n (largest). In the event of a tie, assign the average rank to the tied subjects.</p>
</div>
<div id="comparing-pearson-and-spearman-correlations" class="section level3">
<h3><span class="header-section-number">11.6.2</span> Comparing Pearson and Spearman Correlations</h3>
<p>Let’s look at the <code>nyfs1</code> data again.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb319-1" title="1"><span class="kw">cor</span>(nyfs1<span class="op">$</span>bmi, nyfs1<span class="op">$</span>waist.circ)</a></code></pre></div>
<pre><code>[1] 0.91</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb321-1" title="1"><span class="kw">cor</span>(nyfs1<span class="op">$</span>bmi, nyfs1<span class="op">$</span>waist.circ, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a></code></pre></div>
<pre><code>[1] 0.889</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" title="1">nyfs1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb323-2" title="2"><span class="st">    </span><span class="kw">select</span>(bmi, waist.circ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb323-3" title="3"><span class="st">    </span><span class="kw">cor</span>(., <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</a></code></pre></div>
<pre><code>             bmi waist.circ
bmi        1.000      0.889
waist.circ 0.889      1.000</code></pre>
<p>The Spearman and Pearson correlations are not especially different in this case.</p>
</div>
<div id="spearman-vs.-pearson-example-1" class="section level3">
<h3><span class="header-section-number">11.6.3</span> Spearman vs. Pearson Example 1</h3>
<p>The next few plots describe relationships where we anticipate the Pearson and Spearman correlations might differ in their conclusions.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb325-1" title="1">spear1 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/spear1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb325-2" title="2">spear2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/spear2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb325-3" title="3">spear3 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/spear3.csv&quot;</span>)</a>
<a class="sourceLine" id="cb325-4" title="4">spear4 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/spear4.csv&quot;</span>)</a>
<a class="sourceLine" id="cb325-5" title="5"><span class="co"># used read.csv above because these are just toy examples with</span></a>
<a class="sourceLine" id="cb325-6" title="6"><span class="co"># two columns per data set and no row numbering</span></a></code></pre></div>
<p>Example 1 shows a function where the Pearson correlation is 0.925 (a strong but not perfect linear relation), but the Spearman correlation is <code>signif(cor(spear1$x, spear1$y, method = "spearman"),2)</code> because the relationship is monotone, even though it is not perfectly linear.</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1"><span class="kw">ggplot</span>(spear1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb326-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb326-3" title="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Spearman vs. Pearson, Example 1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb326-4" title="4"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">-10</span>, <span class="dt">y =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb326-5" title="5">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, </a>
<a class="sourceLine" id="cb326-6" title="6">                 <span class="kw">signif</span>(<span class="kw">cor</span>(spear1<span class="op">$</span>x, spear1<span class="op">$</span>y),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb326-7" title="7">                 <span class="st">&quot;, Spearman r = &quot;</span>, </a>
<a class="sourceLine" id="cb326-8" title="8">                 <span class="kw">signif</span>(<span class="kw">cor</span>(spear1<span class="op">$</span>x, spear1<span class="op">$</span>y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>),<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/spearex1-fig-1.png" width="672" /></p>
<p>So, a positive Spearman correlation corresponds to an increasing (but not necessarily linear) association between x and y.</p>
</div>
<div id="spearman-vs.-pearson-example-2" class="section level3">
<h3><span class="header-section-number">11.6.4</span> Spearman vs. Pearson Example 2</h3>
<p>Example 2 shows that a negative Spearman correlation corresponds to a decreasing (but, again, not necessarily linear) association between x and y.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb327-1" title="1"><span class="kw">ggplot</span>(spear2, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb327-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Spearman vs. Pearson, Example 2&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb327-5" title="5"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">10</span>, <span class="dt">y =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>,</a>
<a class="sourceLine" id="cb327-6" title="6">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, </a>
<a class="sourceLine" id="cb327-7" title="7">                    <span class="kw">signif</span>(<span class="kw">cor</span>(spear2<span class="op">$</span>x, spear2<span class="op">$</span>y),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb327-8" title="8">                    <span class="st">&quot;, Spearman r = &quot;</span>, </a>
<a class="sourceLine" id="cb327-9" title="9">                    <span class="kw">signif</span>(<span class="kw">cor</span>(spear2<span class="op">$</span>x, spear2<span class="op">$</span>y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>),<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/spearex2-fig-1.png" width="672" /></p>
</div>
<div id="spearman-vs.-pearson-example-3" class="section level3">
<h3><span class="header-section-number">11.6.5</span> Spearman vs. Pearson Example 3</h3>
<p>The Spearman correlation is less sensitive than the Pearson correlation is to strong outliers that are unusual on either the X or Y axis, or both. That is because the Spearman rank coefficient limits the outlier to the value of its rank.</p>
<p>In Example 3, for instance, the Spearman correlation reacts much less to the outliers around X = 12 than does the Pearson correlation.</p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1"><span class="kw">ggplot</span>(spear3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb328-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-3" title="3"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Spearman vs. Pearson, Example 3&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb328-4" title="4"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">-15</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb328-5" title="5">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, </a>
<a class="sourceLine" id="cb328-6" title="6">                <span class="kw">signif</span>(<span class="kw">cor</span>(spear3<span class="op">$</span>x, spear3<span class="op">$</span>y),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb328-7" title="7">                <span class="st">&quot;, Spearman r = &quot;</span>, </a>
<a class="sourceLine" id="cb328-8" title="8">                <span class="kw">signif</span>(<span class="kw">cor</span>(spear3<span class="op">$</span>x, spear3<span class="op">$</span>y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>),<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/spearex3-fig-1.png" width="672" /></p>
</div>
<div id="spearman-vs.-pearson-example-4" class="section level3">
<h3><span class="header-section-number">11.6.6</span> Spearman vs. Pearson Example 4</h3>
<p>The use of a Spearman correlation is no substitute for looking at the data. For non-monotone data like what we see in Example 4, neither the Spearman nor the Pearson correlation alone provides much guidance, and just because they are (essentially) telling you the same thing, that doesn’t mean what they’re telling you is all that helpful.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb329-1" title="1"><span class="kw">ggplot</span>(spear4, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-2" title="2"><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-3" title="3"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-4" title="4"><span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Spearman vs. Pearson, Example 4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb329-5" title="5"><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">10</span>, <span class="dt">y =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>,</a>
<a class="sourceLine" id="cb329-6" title="6">             <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;Pearson r = &quot;</span>, </a>
<a class="sourceLine" id="cb329-7" title="7">                 <span class="kw">signif</span>(<span class="kw">cor</span>(spear4<span class="op">$</span>x, spear4<span class="op">$</span>y),<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb329-8" title="8">                 <span class="st">&quot;, Spearman r = &quot;</span>, </a>
<a class="sourceLine" id="cb329-9" title="9">                 <span class="kw">signif</span>(<span class="kw">cor</span>(spear4<span class="op">$</span>x, spear4<span class="op">$</span>y, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>),<span class="dv">2</span>)))</a></code></pre></div>
<p><img src="2019-431-book_files/figure-html/spearex4-fig-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="summarizing-data-within-subgroups.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="studying-crab-claws-crabs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/11_straightlinesandcorrelation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["2019-431-book.pdf", "2019-431-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
